package eth

import (
	"encoding/binary"
	"encoding/hex"
	"encoding/json"
	"github.com/ontio/multi-chain/account"
	"github.com/ontio/multi-chain/common"
	cstates "github.com/ontio/multi-chain/core/states"
	"github.com/ontio/multi-chain/core/store/leveldbstore"
	"github.com/ontio/multi-chain/core/store/overlaydb"
	"github.com/ontio/multi-chain/native"
	ccmcom "github.com/ontio/multi-chain/native/service/cross_chain_manager/common"
	synccom "github.com/ontio/multi-chain/native/service/header_sync/common"
	synceth "github.com/ontio/multi-chain/native/service/header_sync/eth"
	"github.com/ontio/multi-chain/native/service/utils"
	"github.com/ontio/multi-chain/native/storage"
	"github.com/stretchr/testify/assert"
	"strings"
	"testing"

	ethcommon "github.com/ethereum/go-ethereum/common"
)

var (
	acct *account.Account = account.NewAccount("")
)

const (
	SUCCESS = iota
	HEADER_NOT_EXIST
	PROOF_FORMAT_ERROR
	VERIFY_PROOT_ERROR
	TX_HAS_COMMIT
	UNKNOWN
)

func typeOfError(e error) int {
	if e == nil {
		return SUCCESS
	}
	errDesc := e.Error()
	if strings.Contains(errDesc, "GetHeaderByHeight, height is too big") {
		return HEADER_NOT_EXIST
	} else if strings.Contains(errDesc, "unmarshal proof error:") {
		return PROOF_FORMAT_ERROR
	} else if strings.Contains(errDesc, "verify proof value hash failed") {
		return VERIFY_PROOT_ERROR
	} else if strings.Contains(errDesc, "check done transaction error:checkDoneTx, tx already done") {
		return TX_HAS_COMMIT
	}
	return UNKNOWN
}

func NewNative(args []byte, db *storage.CacheDB) *native.NativeService {
	if db == nil {
		store, _ := leveldbstore.NewMemLevelDBStore()
		db = storage.NewCacheDB(overlaydb.NewOverlayDB(store))
	}
	return native.NewNativeService(db, nil, 0, 0, common.Uint256{0}, 0, args, false)
}

func getLatestHeight(native *native.NativeService) uint64 {
	var sideChainId uint64 = 2
	var sideChainIdBytes [8]byte
	binary.LittleEndian.PutUint64(sideChainIdBytes[:], sideChainId)
	contractAddress := utils.HeaderSyncContractAddress
	key := append([]byte(synccom.CURRENT_HEADER_HEIGHT), sideChainIdBytes[:]...)
	// try to get storage
	result, err := native.GetCacheDB().Get(utils.ConcatKey(contractAddress, key))
	if err != nil {
		return 0
	}
	if result == nil || len(result) == 0 {
		return 0
	} else {
		heightBytes, _ := cstates.GetValueFromRawStorageItem(result)
		return binary.LittleEndian.Uint64(heightBytes)
	}
}

func getHeaderHashByHeight(native *native.NativeService, height uint64) ethcommon.Hash {
	headerStore, _ := native.GetCacheDB().Get(utils.ConcatKey(utils.HeaderSyncContractAddress,
		[]byte(synccom.MAIN_CHAIN), utils.GetUint64Bytes(2), utils.GetUint64Bytes(height)))
	hashBytes, _ := cstates.GetValueFromRawStorageItem(headerStore)
	return ethcommon.BytesToHash(hashBytes)
}

func getHeaderByHash(native *native.NativeService, hash ethcommon.Hash) []byte {
	headerStore, _ := native.GetCacheDB().Get(utils.ConcatKey(utils.HeaderSyncContractAddress,
		[]byte(synccom.HEADER_INDEX), utils.GetUint64Bytes(2), hash.Bytes()))
	headerBytes, err := cstates.GetValueFromRawStorageItem(headerStore)
	if err != nil {
		return nil
	}
	var headerWithDifficultySum synceth.HeaderWithDifficultySum
	if err := json.Unmarshal(headerBytes, &headerWithDifficultySum); err != nil {
		return nil
	}
	headerOnly, _ := json.Marshal(headerWithDifficultySum.Header)
	return headerOnly
}

func TestProofHandle(t *testing.T) {
	ethSyncHandler := synceth.NewETHHandler()
	ethTxHandler := NewETHHandler()
	var native *native.NativeService
	{
		header7259461, _ := hex.DecodeString("7b22706172656e7448617368223a22307862323534646537333339313834366561343439393066656233336464633266333236303337653232663130646165353939633533646537626363623565616636222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307832373764316465343036313662626363356232653535333238363063646231613332376565343263356135363934363865333835363738316563363663636333222c227472616e73616374696f6e73526f6f74223a22307835303735383837336631313030313861656363366533656564326664386163633761393162343134316338623263373866306665643536636464306532343231222c227265636569707473526f6f74223a22307861613331363939373365666263633233323330376663613266386363393965653833316533623665333431613134393135633130363739303136656665313462222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030222c22646966666963756c7479223a2230783331616235653166222c226e756d626572223a223078366563353435222c226761734c696d6974223a223078376131323164222c2267617355736564223a22307837623365222c2274696d657374616d70223a2230783565333932386133222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307864333663656666636631303036643334626533316337343764613235316335336663393165333633623563323762323631613364353434343530396230613135222c226e6f6e6365223a22307838353561613936393133323963323764222c2268617368223a22307836353834356566633832366366326238363863346462663232363633396534616364346161643933656263636462653162373035663432663035393363333364227d")
		param := new(synccom.SyncGenesisHeaderParam)
		param.ChainID = 2
		param.GenesisHeader = header7259461
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), nil)
		err := ethSyncHandler.SyncGenesisHeader(native)
		assert.Equal(t, SUCCESS, typeOfError(err))
		height := getLatestHeight(native)
		assert.Equal(t, uint64(7259461), height)
	}
	{
		header7259462, _ := hex.DecodeString("7b22706172656e7448617368223a22307836353834356566633832366366326238363863346462663232363633396534616364346161643933656263636462653162373035663432663035393363333364222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307831623138326132383831363564626662626361633661613137333361336130633866393062663538623133626332616666333533323432396164366637613838222c227472616e73616374696f6e73526f6f74223a22307865616336616533356562306639396336613133306264346465333661626534376464613932336266653365653833386236666135333865303534313730623962222c227265636569707473526f6f74223a22307831396561393430653166653936373239303930373565383066623332363665343235653434396662306662313061666166303737363564386261353261336366222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303031303030303030303030303030303030303030303030303030303030303030303030303230303030303030303030303030303031303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303034303030343030303030303030303030303030323030303030303430303030303030303030303030303030303030303030303030323030303030303030303030323030303030303030303030303031303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303130303030222c22646966666963756c7479223a2230783331623139333861222c226e756d626572223a223078366563353436222c226761734c696d6974223a223078376131323164222c2267617355736564223a2230783765373565222c2274696d657374616d70223a2230783565333932386135222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307835373133363435343765636632343630356565386130326438376366646462653736386662353936396639356235646132643333623339356137316632656532222c226e6f6e6365223a22307832623761663433336261613737306636222c2268617368223a22307839326231646136643062313039623239343534653632653431616231613235353863666339663661363533333861666333613662333166656161636363313533227d")
		header7259463, _ := hex.DecodeString("7b22706172656e7448617368223a22307839326231646136643062313039623239343534653632653431616231613235353863666339663661363533333861666333613662333166656161636363313533222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307830663538353965653239346462393134373662623731376338616661313233373235663665633536353737633237656266386434366533323166326561336437222c227472616e73616374696f6e73526f6f74223a22307862306537653339323434613863313736356638633361653565303962363766353464373962393339653335386333613961653864633532316633643164646537222c227265636569707473526f6f74223a22307866316361393239393938643738613035333131616639383137393166633338383135656263643036376563383965623735343733616566316338396130663264222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303830303030303032303030303030303030303030313030303030303030313030303030323030303030303030303030303030343030303030303030383030303030303030303030343030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303034303030303030303030303130303038303030303130303030303030303030343030303030303030303030303030303030303030303030303030303030303030303230303030303030303030303030303030303030383030303030303030303030303030303030313030303030303130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030343030303030303031303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030323030303030303030303030303030303030303032303032303030303030303030303030303030303030303030303830303030303030303030303030303030303030303030303030303030303230303030303030303030303030303030303030303030303030323230303030303030303030303030303030303030303030303030303430303030303430303030303430222c22646966666963756c7479223a2230783331616235643538222c226e756d626572223a223078366563353437222c226761734c696d6974223a223078376131323164222c2267617355736564223a223078373966653031222c2274696d657374616d70223a2230783565333932386263222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307838623638653937613336616437336566383437336365343636643932633634313339396532336364393032366561336539656465613835343035336131343765222c226e6f6e6365223a22307838353561613936393239326336653362222c2268617368223a22307832326437336361356662626230633864376434333339623133613432343339663133343963633735633563616134633935623666336463613235343435633730227d")
		header7259464, _ := hex.DecodeString("7b22706172656e7448617368223a22307832326437336361356662626230633864376434333339623133613432343339663133343963633735633563616134633935623666336463613235343435633730222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307836633836653661613830303566663433356264656639393736653433396434616339333866616466346231656537663031376563333664313661346131623266222c227472616e73616374696f6e73526f6f74223a22307864316635353761623865663631396461313664633266366338363165613034373737616664623766646666373763363964343462653130373165306362656332222c227265636569707473526f6f74223a22307864623563643163643264336533343936653533343762666532643764326561653534356264303466393863373330343364323165386664373065656536633837222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030343030383030303030303430303030343030303030303030303030303030303030303030303831303030303030303030303031303030303031303030323030306130303031303034303032313030303030303039303030303030303030303830313030303831323030303438303030303230303030303030323030303030633030303038303034303430303038303030303030303030323030303030303030303030303030303030303030343031303030303434303432303030303030303030303830303130303030303030303030303030303834303434303030303030303030303130303030303032303030303030323030303032303530303030343031323030303030313030303030383030313030303032303030303030303030303030303030303030303030303430303230303030303030323030303034303030303030303030313030303036303030303030303030303230303030303030303030303030303030303030303030303038303030363032303030303030303030303030303032306430303430303030303030303030343030303030303030303030303030303030303030303030323030303330303230323030303230303230303030303038303030613030303030303030303030303230323032303030303134303530303030303030313134303030222c22646966666963756c7479223a2230783331396566323832222c226e756d626572223a223078366563353438222c226761734c696d6974223a223078376131323164222c2267617355736564223a223078326562663137222c2274696d657374616d70223a2230783565333932386463222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307866643433393339333563666130343861653762653761616136313162623036383638303935326335393262383831313333333366643733323236393637616232222c226e6f6e6365223a22307838353561613936393133333264363966222c2268617368223a22307836336162343534613932666466356634363865356462393031306234633663626334636664393661386332316430353333623638386636633837313334643334227d")
		header7259465, _ := hex.DecodeString("7b22706172656e7448617368223a22307836336162343534613932666466356634363865356462393031306234633663626334636664393661386332316430353333623638386636633837313334643334222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307864663265313332303766336161623238396662393662343963363430326462303362376664396435396266663761353632363164326161393331376462666464222c227472616e73616374696f6e73526f6f74223a22307838383338303065333166303934633664356136663832613631663835316237323232353631303930306139653739626165386534323839313464636334353263222c227265636569707473526f6f74223a22307830353662323366626261343830363936623635666535613539623866323134386131323939313033633466353764663833393233336166326366346361326432222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030222c22646966666963756c7479223a2230783331613532363630222c226e756d626572223a223078366563353439222c226761734c696d6974223a223078376131323164222c2267617355736564223a22307835323038222c2274696d657374616d70223a2230783565333932386465222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307835316430396562623331616664353963626432386663373437393237313437373839343966306230353039303164306235376335396661366130343333343564222c226e6f6e6365223a22307838353561613936393137623336396230222c2268617368223a22307861656632393933313662656362663339353738616565633438333265393332303830393732313065346661646331356230383031376466363966333134346462227d")

		param := new(synccom.SyncBlockHeaderParam)
		param.ChainID = 2
		param.Address = acct.Address
		param.Headers = append(param.Headers, header7259462)
		param.Headers = append(param.Headers, header7259463)
		param.Headers = append(param.Headers, header7259464)
		param.Headers = append(param.Headers, header7259465)
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), native.GetCacheDB())
		err := ethSyncHandler.SyncBlockHeader(native)
		assert.Equal(t, SUCCESS, typeOfError(err))
		height := getLatestHeight(native)
		assert.Equal(t, uint64(7259465), height)
	}
	{
		param := new(ccmcom.EntranceParam)
		proof := []byte(`{"address":"0x4b61a4c0ab51b53cfabf1339bfdb7dfd27be596a","balance":"0x0","codeHash":"0xd5415eb1d2e74e08407476508707137c7e35dbf42995dd07e273c83b4c384c9d","nonce":"0x1","storageHash":"0xac92f34547c3928bff4b16a01d011cdd313f5c8658a0ebbc419d731fc96aed01","accountProof":["0xf90211a044cdba96ea41a639286789665321c82b82da3af44c13a23e89cd7d12489f275ba04f667ad4dd8b93125a461fa90cba9824de0cc6e463963f70546d34eb5d0850ada090b90837f8e344dffde14735d66fb53204b77d546b2d588013f669a6d7cbb052a03fdca5da44fdfa953009a1a393c92af32d4aba170d9d4a355c72d74ff3609ee0a0fb715e667b8ea2a486fa7664b6319f9ad70c8a02a8523ea66018c8a800796312a0e1b0607233b4eb726ec99b875021cd7a419dfa7db281509b09d5e0e586bf20e5a0e0f020646f30505c6dee185e2b15b69b41229f4a5ef3bd1b86a7640323267d0da04a9248c1e2376c795d7e7092f5f269112a5ef0ba9f615691752d327a2e14db46a09434b2e9ce4f7902049c73069aa4e06a64e1b4f66ad28886c1d2dbce4f8d8885a049723843c76c139ee6a852913a15f867bf6996efeab24093831448a3fd319060a0c76af527df045ec8841d3844f75c0df45413eb39e4d133bca4ef6b9f34c14e9ba0e1d251bed147df5615e73e38b5116b9613edfbd40148698ba37d8aaa4c96d08ea0f71d80eb8db1138d42e8ba10e4bbf752e63ba3a2e6202cf77bd139b1f2037909a0cd5faa98e3fb40080b58bafb07477761d5259293313bba9dfa2a717263cc2c6aa0a7da5f100c1ad5e1adc36cbe42b2a75b8e98e7f6ed834f17d2d986220c68dd0ea070e309eb14f7938217f161f05a3322e4334fd71216e2cc39f5581a4968f39c9a80","0xf90211a0bc3c4c601894a3e2e1f63e6a0cb8ded9a45f9d490a48d2e468fa1ef0f811c46aa0ba2c588cfaa0f80fbf358c3122d87c450e0c3c4f4f11ee666f8d373542915ff3a0df808f83f713ba243c4d1f8524de68c1321a2997fe8e90707199fe273eff9e80a0b271d852ef674361d567538ac385fcc3a64393b83e74ca5042a80561ea930f41a09e394e781d7456fec9c3eee07958624ded9f3dd33a7417e911d829f1b8a3fc2da038836c839d052cfac47eadc38eef898e81a141b861aae160b458dc2a810377fca08e0f1718e800fff19325f89e794371576d317ef69a42bc58a7d06bb22bcea109a0248d5e1d35531a8ae584f4748ba9f066b2db80b66988735c4a42ebe9fe840e32a0f85898019742452e3e6f13ab0eba8be413f703f9b6ddb738a8ffee3a5b6921cfa0d8911f2a5d448d870e75995b5d424040f639ba07a018813c6c3f4534b2a40588a0940046d1f708d0a435ae58a899dca8f0cc2b10ba37bfd5a8e1ea31d2a6e7f370a09cc6a3faaf4dbb3ec1c6a545f69ee5ea4be632edfd7da38005466de113f4fe1ea071a50ff6f949b9b7b39754857b10f8e988f378e740c917fbc47d07363f348eb0a0b1df183e8603fb1c3aad3af711d2e15696f256f5dd2c94bd88be390f13013762a018f2794476d5b40a054196c7f2aa218c508cd4f10a85f71222a7c08ab5cbd109a0f296cfcd6b516e9c8d2c1a90c5ddd8393667baf9b7fc37f7b403f3a26d36e1c080","0xf90211a0616b9d83bd7f96de1864f0fe3e16badf4dfa89b8f3eba721a46c7f232d930e5ba09e71d9854994874d673e049153c7accf44196a6211b80ef97b3d29e636db521aa048d549ac792bbf2e3f07a7362b81f8817193c446c56eb66b71abe7ca6fe5c6a5a0e120d0b4dadef4604bd8b9250ad6ca3ca6b11da171e209a566924950af03571ba067f4f8626b8af02a4b7a33e546a55845051b3b81cde0e045d4508908b27a49aaa0ed55c43c8d4ef28c54b641660d457d4e0956cc1c63a77a98f39dd5f1f185b98ca08ddcf649ac1ca8df725e021298352a5daf44f9a1caedecd9fef2bd509ae43c0ea00223058d54f8445d1e53e2586600db633ed9aba3f81fa9977fabde53fca4b4d7a0c39638566db5d144df1521afe1e7451ec1836ead2eda423443b66ec0e113de30a011a3c497474d46e16a1f15c3558d5043a994a7df3e4f7e68025f344e12e7de85a0814c5111d3853dcfb4b3008e983364d68869897ef3d246e482f5d51c97dbef10a04d1605e0a23e25bb985b83a0f9743e632c737336cdf7394c1a9a4dfee19a9168a031e6c9c8329cbe268f83da4e8eca50a20a95c28f15780d332625f51122bdd797a05c1fb1a5be55ecc86189fd3a9ea070ec9e4b9394618c9cba8ef47eb77488dc02a0220348f330a91580351ba1be5c36264497e75f6fc1ddf109c80e0069819347f2a0809145f936a7b913fc86edc2dd914b5c835b2b17a4fb2cafda62ca6d2440df3680","0xf90211a0bcef09832cca3e0d23f7ea55f6e605bd36141a362094e57a698fe5a086ab3f2ea067f569bf8e06758f39fc95fb312f808cad88dc7a62cc82937ea7214d43216fcaa02832f266942fa9a3f6b55d05f8e6f1408f6d82356a761578c7dae9408b7f0d50a0c75bd37f1e94fc6c322e3e5b50b3e36efaa626b457df7ecacb3b8e65fad53bbaa03e4ff0b64aa60e9ea8329cadb49ba89f7cad0c541d525956b7484133aa973979a0d32e95abde9c3278cf4e7a16d4edcde194410ae0ce8df4ff78c5441236d53837a07703f8673c8d74beb4e639d0a4603b9026e20fea0c6547eda433df2d9b53dc56a0fac583c68287d294eb76815bb4841b992187add002f0e563b891e71d157af33aa096c85eaa274319ced0ead3cd0054563b59a2fbf750542e5029b83a5a5ded67e2a00cf31256126ad966492d04f22dbbc70880a5dbfcf3d795842b1a1fc36684e419a0359a1ab3ca5de3682cb57bbf0d5c9959f6c964e0f7c0e99580de14108fae6d9ca03e165d0a6c4d7e02bf4f459188eb5a0ec51ee3f960eaec1a8d9efa4a25e2fd25a031444ce52cb0b9d698f314acbbea8b98ca6df2a789ba35f1af64b07989659ca7a0b6e6da13a8361f323f7391facc8a20c5af184c8e345ab2396c94c868f420653ca0259dbbb9fed067946c475cfe4919ca6ac8f089fc61aa7fbd76f3b9b8f6271617a05b2f4edce7b144f1f00fc61539ac43b772684dc1953ad3a885630cb351fc257680","0xf90211a002e5af012079123236fdb908236ea6aebaddff546e2580424101a23211fbde75a003fd741237eb90196f5822f91888074b2180d250a8ff48b41563cd94a817becca06233754ce9b2df7e1ad659e5515b042fe9007f76274f38df178ade77f5b74440a007f4b142b3b9599e91052f14872506bb1bee0b7ee70dc242d19268a0d0eeaa12a0a0b5f6499ae2ef83a1be1e3d73e4b88b3d322911457e97abb42a23758bb351d3a08e35b9b0f4ad1b5a6fbddcdacaa2463d3d4d7c8dd406ce19cd206c6595db674ba02bf200d3016a9e9eee1976618999c27abdbd63b3c5e675d64a833b1685944352a024e0583914d4ab6c6cbb5aac193b479d48ab3254ab3e88e5b6544a882dcf8933a09d7b11fa377dbf3d92f06faea40962189f388e87fad8cf0ece2196b8b30e9da4a01667268a20948d7525d576628d2ba3707a94d3b1da0ba7f28a45bba4737d2894a08c0b6a7b94d696bf5c532c613e0feb3dba82c55c4fb01134c83c319402d2b871a0026671a3a43a954d025e47e750244cf4b04a8354fde6cbea9c467368049c1feea0507b816282aefd8f3b582bd6ae7d5acb037b313debc2028e57b9cae229e1db9ca09ce3d88f7e1f321e187d1b234c2493e81b5d7b47ad6f0cb0bfd1c9ac5e5f74a6a092c2f1e2ce6ea1015f77d98c0072e7ec9b1e18406b0ba41cff9c1cdae71c9542a0b34ec209c27899ca2b1ea2d07361ea00628d28e53414dd6bfa39c39cb7eaf23e80","0xf90191a07fe5ff2aa391a7ea09ac6d55f4621aaf23cb322e559c110f3bc3c7eb3eda7a8ca0230e6812eb0e8bba2ad95edc695412e33e85539d0eab1e96968bab9f9f1f019c80a0d28dd1d2320e9e15e8bef5636e8d3e2c9b32d9c1475c78e4a435bcd3e19b812aa07a33a6998479f52a1d7c06d675a6e876c68727a61caa34e39115f03efb3afc1280a0dd4290c3837afd01faa42f458e0486bbfc4885b57b5c835f0ee6fcf55b21a394a00f07b81acd0335f3263af89f877e72bd60a5b2b5bb3e0d6d8cbf5f5f5f85ce16a0e338a2c0be8577567cb62a6d58a95d8f59a5ff1b2711f75bb31ccc094bf7aaafa0d5b82a1d9af21fee4199b9867316f027f9af7d3773e1710ce7d200a93c67fef8a023963250bd9f8e7a05e57c71bbeeb1c2543777aad8175579d4a285eb966e2cf580a0619d3a8d0f12f692c9cb482d18f6d89b9f4dc4387f1a5c3d5695a58e169c6aeaa026047caa832100fdac0ade771d2559e4b250c1ebd4d3f2c58ce3ffb8a73a3a54a0aa24cea6d585f51e7363e9188e0ceca15a2fcf8ef7b06ffb8a244e38444893ab8080","0xf8679e20a156fa491379eaedeba66e5a505622acecbf4ba5671e47f00370827178b846f8440180a0ac92f34547c3928bff4b16a01d011cdd313f5c8658a0ebbc419d731fc96aed01a0d5415eb1d2e74e08407476508707137c7e35dbf42995dd07e273c83b4c384c9d"],"storageProof":[{"key":"0x50a82f9cbcdfaca82fe46b4a494d325ee6dc33d1fa55b218ab142e6cc2c8a58b","value":"0x2d37cc264865ae01b30172c43ac9ace29ba1dee20f10aa74ce291b26689c050b","proof":["0xf90211a0b07d4dbb8e1e7f7357496c011b008c5a49531e90725e1957d769dc720fcbd8d7a0172557790331f25ff2b5aada1d25bddf0fda4ea790a40ef0e596a45fe173b1e6a0e312e10d94bd7dad39723078aba881d4235043bc3c1ab59f44cea61c0e56a1b7a04d0c28f3e08dd98e7ea6597fbe6c604592c7f2359db9bc42bf3e4b8bf42459c5a0f1562a82dbc1994119ea29a65f255eda43959309171b4606f4011cafd0173ac2a01fc25384137fa860cb740f1811cea39bd6a5c86f52d45ad6d3a00b40f60d444aa089f45efd567de9edc6a8bfa4bc8684dc4118833a51a5f20d6d7c0e719586a909a06b6d587b1aa7fc7d81a56bc9cd20d621a1772c814cccc873692572bca93106d4a03d51ba86ef58614506f4c4425eda5692e71a818171a669dcaee5ea10f3902e38a09566b3631d046edda78a244db59304ccd8cea8287d23dcd0d03a77fcd60a0c1aa097c7251c12165854304785062c881394e9eeacc9bb55dd08a9331730bcae2711a0f677cebfff0adfd030227685d7c231fc9c8ecedb8b0fa62250948ff6f895efa9a0106b34679f06a804b941370b81bb6d68e79505a387a49dcd236a0a88063aa527a0579f36e4d3ae280c83851cb791e4ee75d80d832762e95275a15c1ae33657d9ffa0b7ca9f6e6fd1d25fbd44ced8561c290c3cabbf2891b4b8289ca54d671e887430a05177446b71571d22b976133f873355c383667a2d60e1ca3ebd882854a7aac8f580","0xf90191a0525d0baab303e971a33085929b03ad88fe97a9c2ab92480a4d09720599581c11a0e783b08ecb0ae24cbcb1804bc4f422557bce71f077adf4edf7c275a745ed5b2a8080a0c310a228b83f5310ca38b83415b7113ce621743b74fbbeb907944115859dbb4ca0085b66671b0eb402d360bfe181b2cb883720167bd782bf4bbdf920998a001414a05ee03832f17957b631b15db06fa7bdf3b8f0cd1c61d27af684ca60bd15e041bca0a4dae0acbd7fe8b71b48f520fef3c35b946cdce186b76e675595ddbbedb59363a0f81d3a61a2a23dc07866ea1ccaafb4368da835809cc7159ce8703ac8ead6cdcca046d79da3f2ac115f3da3e0cb95a77e778da969b02aa20a8841907a3fd4e1076f80a0e1d17b106cd31499d9700b73d5f8b5c5bdc02835ccc0486dc9d4d0b834de8a1980a0d860e04becc55860efa5f851d389d43d40177caa56f6244e0213ff58ecfdf53aa0dbb6dfc13a9106cf6aed1840f26a4a41ed9ad97b7f87e09cc1eb10beaee87092a0e974b76e9fd2af46966cbdf4aad7fb986b68ce470a660f6ac37d393149b99dbb80","0xf843a02038fd5b02a17455a63e08ef8acf42f0c690bb3323f43c6cfc048729c3a46670a1a02d37cc264865ae01b30172c43ac9ace29ba1dee20f10aa74ce291b26689c050b"]}]}`)
		value, _ := hex.DecodeString("20000000000000000000000000000000000000000000000000000000000000001320000000000000000000000000000000000000000000000000000000000000001314662e1b7ba042f389cb1b26c4d988e137d540fc4301000000000000000362746306756e6c6f636bfd1d01226d6a456f79794350734c7a4a3233784d58364d746931337a4d794e33366b7a6e353740420f0000000000f15521023ac710e73e1410718530b2686ce47f12fa3c470a9eb6085976b70b01c64c9f732102c9dc4d8f419e325bbef0fe039ed6feaf2079a2ef7b27336ddb79be2ea6e334bf2102eac939f2f0873894d8bf0ef2f8bbdd32e4290cbf9632b59dee743529c0af9e802103378b4a3854c88cca8bfed2558e9875a144521df4a75ab37a206049ccef12be692103495a81957ce65e3359c114e6c2fe9f97568be491e3f24d6fa66cc542e360cd662102d43e29299971e802160a92cfcd4037e8ae83fb8f6af138684bebdc5686f3b9db21031e415c04cbc9b81fbee6e04d8c902e8f61109a2c9883a959ba528c52698c055a57ae")
		param.SourceChainID = 2
		param.Height = 7259464
		param.Proof = proof
		param.RelayerAddress = acct.Address[:]
		param.Extra = value
		param.HeaderOrCrossChainMsg = []byte{}
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), native.GetCacheDB())
		_, err := ethTxHandler.MakeDepositProposal(native)
		assert.Equal(t, SUCCESS, typeOfError(err))
	}
}
func TestProofHandle1(t *testing.T) {
	ethSyncHandler := synceth.NewETHHandler()
	ethTxHandler := NewETHHandler()
	var native *native.NativeService
	{
		header7272741, _ := hex.DecodeString("7b22706172656e7448617368223a22307836363832646166326232623733313866366562623962633035373962336662373266613865303634633333646237313563303430353165656662633430373532222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307864376433353862626437616639666230376534353337333534363763633236643739393065323864626330313639366363633130343136646161323431636662222c227472616e73616374696f6e73526f6f74223a22307863316432386234343563363939346132316236666363663339376362343831623566313131626461613038656537363965376438636232333235353432656366222c227265636569707473526f6f74223a22307862333463373435653466326633333961623866313531333363623031646337663436306366376139633738386131343335396163633237343731376561646233222c226c6f6773426c6f6f6d223a2230783130303030303030303030303030303030303030303030303030303030303031303030303030303030303030303030303030383030303030303030303030303030383030303030303030303030303030303830303030303030303030303030303030303030303230303030303030303830303830303030303031323030303030303030303030303030303030303030303030303030303038303130303030303030313031303030303030303030303030303030303030303030303030303030303030303030303030303230303030303030303030303030303030303030383030303030303030303030303030303030303030303030303130303030383030343030303030303030633030303030313038303030303030303030343030303030303030303030303030303030303030303030323030303030303030303030313030303230303030303030303030303030303030303030303030303030303030303430303130303030303030303030303030303030303030303030313030303030303030303030303032303030303030303230303030303030303030303030303030303030303030303030303030303030303030303030303030303030303230313030303130303030343030303830303030303030303032303030303030303030303030303030303030303030303030303030303030303030303030303030303030222c22646966666963756c7479223a2230783332356364633334222c226e756d626572223a223078366566393235222c226761734c696d6974223a223078376131323164222c2267617355736564223a223078353366653232222c2274696d657374616d70223a2230783565336264393333222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307861373235363838353730363139393837623435666635306337313238623433623533306265353563393337626130613939613663626164396638326664393665222c226e6f6e6365223a22307832623761663333336134393931376633222c2268617368223a22307831323632646163346633383738343130326661343535326536353733323565313931666330393236376138623137323130643432613564373636383439613034227d")
		param := new(synccom.SyncGenesisHeaderParam)
		param.ChainID = 2
		param.GenesisHeader = header7272741
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), nil)
		err := ethSyncHandler.SyncGenesisHeader(native)
		assert.Equal(t, SUCCESS, typeOfError(err))
		height := getLatestHeight(native)
		assert.Equal(t, uint64(7272741), height)
	}
	{
		header7272742, _ := hex.DecodeString("7b22706172656e7448617368223a22307831323632646163346633383738343130326661343535326536353733323565313931666330393236376138623137323130643432613564373636383439613034222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307830366165653464323138616238636535366162386233366363656164623737303335323336396461643364343564306536333832333638616662356263653037222c227472616e73616374696f6e73526f6f74223a22307863303134373631626132613561386165616236373136386465666439333138343138633362316332623461353532396136343436653533353966326235333265222c227265636569707473526f6f74223a22307863666633353566303239336632393536343661343633396261346564346662666130323835336636353738653738343738333862346136363635633839393331222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303830303030303032303030303030303030303030313030303030383030313030303030323030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030303030303030303430303030303030303030303038303130303130303030313030303030303030303030303030303030303032303030303038303030303030303030303030303231303030313030303030303030303030303030383030303030303030303030303030303030303030303030303130303030303030303030303030303030383030303030313030303030303130303038343030303030323030303030303030303030303030303030303030303030303030303030313030303230303030303030303030303830303030303030303030303030303030303030303030303030303030303030303430303030303030303030313030303030303030303030303032303030303030303230303030303030303030303030303030303030303030303030303030303030303030303030303030303030303230303030303130303030343030303830303030303030303063303030303030303030303030303030303030303030303030303030303030303030303030313030303030222c22646966666963756c7479223a2230783332363332376366222c226e756d626572223a223078366566393236222c226761734c696d6974223a223078376131323164222c2267617355736564223a2230783436613330222c2274696d657374616d70223a2230783565336264393335222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307837666236306135613238386433386131376433353030323934383137363662613264613837613566333661633361636630303639346436653765336664313663222c226e6f6e6365223a22307832623761663333336462646631613961222c2268617368223a22307865373934393430373565663464623932336537336561336335343533383963313039643063333666623563613338356338643633663833343037313065363364227d")
		header7272743, _ := hex.DecodeString("7b22706172656e7448617368223a22307865373934393430373565663464623932336537336561336335343533383963313039643063333666623563613338356338643633663833343037313065363364222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307838613861613037373438393737303430313739393233386339323734316665383761326461666532363365643131313236353763613335303433653563653739222c227472616e73616374696f6e73526f6f74223a22307838376264656237383837366338656364313131643266663234303236393562313232313435346465643230306538396333626430613432656238636163653563222c227265636569707473526f6f74223a22307837646564646431333635656563393231336330356662366531336364323666323530663732366163356234333561663566313461373237663964366333316266222c226c6f6773426c6f6f6d223a2230783138343132303030303634306138303030303030303030633030313038303830303430303030303830633830303030313430343030323130303038343033303834393030313261313832303034303034303030303430303230303031363030303030303030323030303030323230313033303031303030313230363830303030313230303030343030323030313030303032303038383038323932303030303830313030303031303031303134303030303032333432303038303130303232633030303038343438303238303132333038303030303032323030313039386330343030303030303030383132303230363030303930303130303030303030383130303138303061393034303830313230323430343537303038643064303032323030303634353830646130323530323130353032303030303030303030303430303234303063303430313030313836323031303030303034303530363230303839313030303030303030303030316330303838303830383033313031313031383030303031303032303035383038303230313438313030303030303030313831343030303030613030303030303834383030303030303030383030303230303031303130313032363432323833303038303830303038323838313030343236303030313030303130303030303034316330313131306130323432313434383030222c22646966666963756c7479223a2230783332343966363366222c226e756d626572223a223078366566393237222c226761734c696d6974223a223078376131323164222c2267617355736564223a223078373963373034222c2274696d657374616d70223a2230783565336264393638222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307835336266373933313130393633313833396139366134366132363935343766653736373539383130376630343439633634316636386139326330313838306439222c226e6f6e6365223a22307832623761663433336137353263653739222c2268617368223a22307832653839333431336534313934643235656331653335646633326630373161346139613664353564653736366430373131613561393139373161616366383933227d")
		header7272744, _ := hex.DecodeString("7b22706172656e7448617368223a22307832653839333431336534313934643235656331653335646633326630373161346139613664353564653736366430373131613561393139373161616366383933222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307836373062326330376437316433663935613261653735366363616231336263633233653432363066366231383338306661363235653439616163363964613737222c227472616e73616374696f6e73526f6f74223a22307863313137303233333264633238336336646162396537383634656164353466373338363135383466313939363136363264323731343664636339653865623436222c227265636569707473526f6f74223a22307833303336616138623035316365336537623633313537303065656365653633333665393138373461326335666635373235393666326262363235626162376263222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303830303030303032303030383430303030323030313030303030383030313030303230323130303130303030383430303030303030303030303030303030303030303030303030303030303430303030303030303030303031303030303130303030303030303030303030323030303030303030303030383032303030303030303030303030303038323130303130303030313030303030303030303030303030303030303032633030303030303030303030303030303038303230383430303034303030303030303030303030383030303030303030343130303430303830303030303030343130303030303030303030323030303030383030303230313031303030303132303038343030303030323830303030303030303030383030303130303038303030303030303030303230303230303030303030313030303830303030303030303030303030303030303034303030303030303030303030303430303030303030303030313030303030303030303030303432303030303030303230303030303030313030303030303030303030303030303130303030303030303038303032303030303030303230303030303130303030343030303831303030303030303238323031303034303030303030303030303030303031303030303030303130303030303030313030303030222c22646966666963756c7479223a2230783332353033663764222c226e756d626572223a223078366566393238222c226761734c696d6974223a223078376131323164222c2267617355736564223a2230786134336136222c2274696d657374616d70223a2230783565336264393664222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307833656133366661363130396566663237636265623238643139613433383935313436623336646438633337376265356632373636306331323336306366633930222c226e6f6e6365223a22307832623761663333336136663239303233222c2268617368223a22307839353935633935363532623765623766303030656362393562666361313262363562336439373535396663306239653232303539643339363338306232343531227d")
		param := new(synccom.SyncBlockHeaderParam)
		param.ChainID = 2
		param.Address = acct.Address
		param.Headers = append(param.Headers, header7272742)
		param.Headers = append(param.Headers, header7272743)
		param.Headers = append(param.Headers, header7272744)
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), native.GetCacheDB())
		err := ethSyncHandler.SyncBlockHeader(native)
		assert.Equal(t, SUCCESS, typeOfError(err))
		height := getLatestHeight(native)
		assert.Equal(t, uint64(7272744), height)
	}
	{
		param := new(ccmcom.EntranceParam)
		proof := []byte(`{"address":"0x8d069f5a5b877d9ecc5ee28715982c12f3879414","balance":"0x0","codeHash":"0xd5415eb1d2e74e08407476508707137c7e35dbf42995dd07e273c83b4c384c9d","nonce":"0x1","storageHash":"0x5a9505e2fb5e470a9073d6101c489e5c3389494204acdaa7d09a86739dcbbadb","accountProof":["0xf90211a0c0bf99bbe468b652dc210673bbb895d83d14184aa128c2bb66f56c8bfb493ff6a088a0a8c647461c7c75547200d3b2543b8378812d06e410e5d4bde52cc5c6ad66a01ab18d075edbcd6aeb96bfcdc15087cc4d9926b439542e24436b8f419c307af9a09c346a18b0b4133e38c13cc92be342567249c23ccb7250095be2c59cf1fc4883a0b579d319a29d6640fcf55a54d5c256b58e4f0ca3480bc87b40828a880d20c63ba0696b5b5096a476c30f18d106e0102de5a58232635bdc82cab2d8685bec4d69e5a09f6f6bb124346889dbb187c03323d55fce9729aa1bdb7a24e339f57ff5caa99ca0c5a2e8941a8fa98e4b880235d004112f222a4e9960a0b952d471a1574af44defa0f7c8d83e0cd3bcf20f075c26f55cb10c7c99d863eaa04dce31f22110b458eeb8a0eb1055c8367eb2d20bb76128f45ad15a141a0e9e9a2f98c94185b8816e1fd697a0444056c32a2ae093359c114680fb3301edd860621ee50e553726f9d726535e04a0f4c8875638ae118ff97addaaefa64a0c135eedcd2ab8cf933a71667bf1c5b77ca08a6c80369cd79bf11e6cc006b2947d98de3ac3660f8707b8b915177936347042a08d1a8650117867a22d138a7e80b10e2a62c7b1925b2871a61497c36362b87c69a02f3276f0b49f16cd5405f8124862ce84139891e044deb77b5e8c5da3a330c595a003ba0fda4b059a8caeae58246228a1813f25ed1ff94c600e611014b21ee8a28080","0xf90211a0390f19abc088428c70238f0ad05cfe6b07ae6c064afb76cf651073f0cf7b893aa003839e568a36a01864236f731fa5e0070a6af6679d22f87d4e04a9621298957aa04e8022ea928018d3dc3beb81b95275ef021312c7e11821bb8b78cc37ac542ac3a0e0a39c2b9431f6ba97d1f2a86064cadd6f368cfaaf707606b9215e23bb6316fda077c21f47559c488e3ae18ba5b019614c73d84db8b1c21db816f2e1af2d3eebf9a01e4c851e9b29c8a28d0712bfd77e1de8027ce845bda1880b53e547662defe957a0c4504f211d96da973789e443aeb451a36752f68e9e725560fbecad08d6d70d8fa0fe795d4ea51dc3fc628511ff9b2299577c3f159834fc123dbf8d35006a8bb8f6a0cbd86499b7e7bab7aeaa83d8fa54530943b229fc5c1e6561b887410e5f5b163da0d7c0abc16cf26805ef8bb64b2a1c16e8280e6c0f783a473be35d024b7f679d9ba057a2faa15aab6cecf4de18b0e799f56c737358547c57294de8c77c4d517e5c19a033ffe1186c9408c86bc1a8645527571d10dbe553236b7062552c3a6874bc2f33a0784b2b0d3e7485a163225162651227f5635660dab1b7e15adf92570a2ccf5b1ba0d2b8e2e0b526a86914c2e251e94b02529a626993ed392380834c36ade13d8793a065f6becd28c0842d2ab2e4d87ba074391fb7d865b392097e0e0f1a3a5e114e93a0f7d0424d2a703d91cd56daa9ce4101e0fa700342d93673ba2b3c247ee3c035c380","0xf90211a048597c68f27f42e8266982f2f8cfc0f91618646f1ffb58e053dcafbe285dfc4aa07cdffdb2e9e5bb5018b2b559909b1b9350d146c7322fc3b8a7e22b5fb28c8f31a0232f828236107d8c89bd09672e952488c4807c8284775351f86a0d5254c68808a0efef2d927e3ab847994bf3700b699b126a74ec476e1171f797460c275da9577da02cfade6c3e4e821998d3950f2aa7aa500f3ad69f45fd4c82de7e278e3913883ca0cf409ea1fdcb7ace51b35696ff6530d2d60824e3675c8911c7bc9bd3fd4363bea0c5f51531da18abe454e69d11096e65167243c35de24a7f7f4b441d31a397f6a0a032bc787b47e42486a92bab2d09fc4b094c0862fbd0b86dae6f0022ee4a3b5d01a0eb54a52e14d7db343526cc37ee048bf2d6b4ae3785bdd2229b6d685fe819d79ea0c5d49f00cf0c32c2ae8f7e12af597e4c57a82c0990b77729b73a38c86bbba793a047c6ea45ccbaf02f1f57136ce81ced5d885d760de0a1628175311c5b77c232b7a03996331f1770f32d05050ac62177693f5333949a5b2427d1897c3f6a69f2f2e3a0ba1d28c01823e0aea3668626dd84936927cacb759fa1cbc736f2b539d07debb0a06940b8505d95090f908ecf8354f78b0e68eec84d15ea5672a429b50876cdea84a00fca72a9f8a6f5446a7ea2b805bf4872f373de66cf98e565f12dee5ed7329cfaa0cbc1967cc563439857ebffaf1bc181829cef5d5ebf45762d8bcd112773f3bdda80","0xf90211a08825c68941c4ac52fb1708078d3455d64adb2d6041eb13da4abd6a2fde25e2fda04118c05fdf1be1b5509a0c992f0b7b6b18f11a32fa8eba15c8cc1554c21f0da4a0eacf346a8d0601b97063c27df668ef26bfda5bc53c0083350c3a53fb75e5add9a0ab9864907769fd39f8c4dba7d76c270649ea5ca0111e617b6638ed65185733aea0a17734b977763c500fc3d7682158afa66cdfb5873eb3c74aec542c7dd03d9586a07406cbf145d5fc56bd2eb34880986e266d518272f3e129634d24d2b734599ce7a0787f885a477b35102416253d1a9211110f0353db7c50223729371afd20ea8174a0ba1621c030abf1f75ffc52a334d208b22e1102917f3afdefc5d867d55314b9dba0699a40e9cd369f28c059280fb854326684dedfa75f3480187e8c387411f948dba0ca8d8163024ab2b996ee3448e12bd189f9d85555f70840e6a71e4c7b7c834da2a0631d8043dae7633e9ab7b95fb4ec40f768ba59858d520e0ff3962c5dcd15300ea0f88cc4478e6ea0012866adf76b5507679c9cc598efea9a7c5d6805d3b8be2c54a041b5ae344e6c4ed6449e1f5493313f6faf2298c75c4645191962a15e3cf71a41a0deadcf39287069cb88a1e58ea22988648bcbf1b562a4e27c31db6b4faff02f02a0f9a0dbfdf1b23df52eb4be9a6598ef6cf698ca57ac93bd370badd66fea8106a7a056aeb164ffa1b1a6c13d453fe92c9f0dc5f997919d5c5d8ef2ef234e20b1a34e80","0xf90211a0c423763462f31f12c0e32181601e76dfafadf44bab89ada67570d43dd7b88862a0f0598e24ce6df2c89661b8ed63424e1014ba21c664a8fb7d0ba83d8d99bd53f7a08da8c8d66fa171ce6fa4d3c701072ded631c0708580727f8ab676f8d3f82947fa01f45118988e3315c230ec4e23252b94050aa816238f3fa9f851feb596166c97fa0f1344000f147fd5049433321a125ee30070e74a304d1845ea23077afc2054241a02247602172797f0f106b4a15a91981cc747c108e9a479c893edb30b64232c3b8a0ff46da37205525038deccfef623d3fdd85ca73484c8e0832cfc89547c6962a52a0d372f69118c5939534627ea6d4f32fe080fd18dd1e8ddf3a2c27c515d51518ffa04c7a6b2e5fb7d545ea92fe128320e3c2545147a4cf64d16a1a88d4369cbba608a09b9de9fbf4595d4a5ecbfcb1384a51397c6f4d519befe13148d3f49aba8d1659a0d66538ea3f4ab97f9c3ea8843ca845f7e4ecaccc0b8e33fb9775a4323749385ca071b3caa47a51d29bc62a14bfec2ef82444fdcb38a304f3416e97f56b9acb1e83a0bdfb50a24c2fe4cfba92ac3bb176d764ecb306f1fa812c183a82eeea3fc39a18a0c53d014d235ebfbf41b3108bddca048dbcbae4fa1530b4c571370883c81e5af5a0e7c0f349d1346dfa3d8bf54cf86dac87c31829a3b7dce889fb74dced3041cfdba0bac0f43b139479c08a92203bae67d77cae368e1bf3857dd2d038eec0978f138280","0xf90211a0deff2c78facd67bdd752adfaed2d1bd785122e30fb9b831bd815417f0292baeaa066a94cc4537bbfc07d4c8df80bc1eab9c51c7c228a1aa84f383074f098dbcf9ba054dbc3bd1c18ea17e0175e16358ad7e30de3e3c587147a6ac35ded187b59fa53a0b9f37a7c692b069f786d4c251d6092918657a0ab80b7e342da77741f9169ab09a0bb3ae6c0bae28ed8c32b94712de09a5faa48aa52b6fb1972eb5ff6a20d05cfe7a0cf3eeaf40fb8bc2084c04e5db06a6ff5083967ec7c3b50f6b610c5fe7ef4b074a0c4a44c5a484ce35240af24aa25a6f6d730ee0326231a898248cbc63884604387a0d718c7d24ff060799e644104035c6959bf80e7040decabaaff05b0bd062a811fa0ad8e8b1b069c1af37b798a7a60091d8a88af40a844b751ebe8b8abeb8416d39ea0d0128a60d2b3433a1710c2530b09226c6635fa8469abe651bbfb2f69cbb31150a0c81ff500df29c6eb34e77d9249a68fafb11c1fab9a0c612c34599e4e0a99c783a018befafc88076ed909d12a2eb2b12a4be09829e663f57a0c6cc6707aa94c6e7da04d3f8f50c468843000ca435a47ceb4f926e94321f74cb4dce5f4b34efffe85dba0180349f996985ce0a820d35bff94185e2e5ca7e14ad6b5515da5e2443ec644faa07ba8664c88dbdf5ba34016550a23a1e40d9f88c03a1081c7296fe142006afa26a07750aad81ec12bb52b22af86642d6017175e2ba8f9cf9cb0b4e09535c072cb6580","0xf85180a0932c0529e12d0fa306654f6276a0b49ebe2ef35ca63548d419b2bb4d94fb8b998080808080808080808080a0f60803ca53282fb28312d69ae9bc3dd29f0e131a19da8591b2382b7fee200219808080","0xf8669d3492cbe0c4cc38b98898c3be4350da6c91ec0add9503273a55901cb4c8b846f8440180a05a9505e2fb5e470a9073d6101c489e5c3389494204acdaa7d09a86739dcbbadba0d5415eb1d2e74e08407476508707137c7e35dbf42995dd07e273c83b4c384c9d"],"storageProof":[{"key":"0x9a215a401a334e0d4544e852c160ee647d373a69d4f8652344f59d6ab6019d14","value":"0xb93cdc2c48e0574cd27a2fcb580843fc6c3441bcbe467532a9c52aa6055460","proof":["0xf90211a03d375a7597cadbaf638b2a6d597475248aea4bc3ee60517f8e7d8b3b05a6ed48a0037fba1102f4e07ea3911ce52dcaa87b7dbe891ab54d36d02d1b77eee81c8f37a00b774cf5659daac5932eb0c3697b560123d864d88c4308753f38e583e93bc6aba01f94a45b29926a79d359d2e1b2e2d83a507bc0b97b22115a091965d213e7b61ea0785c1d222224a557a6da8f0114a8e2bd0e42afc68c1591cb1c6f218184fbfd02a0152522180664dea9f568eb992fd12f9ece817b6e9340ff1d19666bea7ea609a9a0a8fe0b919474c2de6a5016ef4a787e9d6cb218131827ac0c3e22e1dd089f7294a0782f3a4cd760b278d7f5ebd48f484dc7bac40f757ee6f6b5b2e06034f737f697a024251b5820f70f1a1582d4f3213bfb2590a5d413674c6bf9ecda729297fed9c5a0f8cbdcf26fba1d904644b7d0e44ca7aa84d395b0575007f7b1f9ee1755832ee7a03895742d3dca435335a48d45491a3793db06bd94e45b9b43669013b72c2f3699a0d91b0cce7241a273ed31f86e2cefdfb401acdee78909bd30f30b2b5090463907a0883487125536a0a426a06f41933a19928231dac3c276ef7670df67a44427d54aa05db21ea924b46221642101c79d503cb3501a8a6b98401b4fb3219132687857c8a051d6bd2a8b65712b919bcaf3a5eb1655ec87c6808c3bf31347b61acaea16de50a06940b3541e820616e976d9e6fe58d339416e3bad61f43b75aac20768975881c780","0xf90211a04ab0e993ee62cdbce74a989d44adf18ff5d98e4ae8a3594fb29c0acb40eb1d99a03d66af097cb12275aac3117e694afedee36e55afcc22c497f7640c3c360418f0a0ae31a4b8f3f64271911a0e262a53cc1018518a2954f03daf9ef348256ce9ae4ca067c4cc2afe483274f2a5496566a7aaf93a67f9377151cb0796e41f867f44d3dda070cd7189010f0564619c929f793860aafb2dab3669fb12e95f9d5207ba3fc888a0713fd0048301ebd0d5c679cf167be8ebf5ac3672909e56c7c3fd2626d89d2256a07e6aa96cd1097fac233773029136d9b576b7d213ed55cc6b179baf3b6c70b11ea0a1f01f9db2409f6faa40579bc8dd600fe6696da5db67265a561f098cc4ab77c8a042653bf9cbc05af052d2fdd1f97980166f4b0a89b12ae6e0e631967a6567c43aa0d1010f6e38cc8de03f9c29651c3bb173a31d595b7d95c5978f772c73761e1c2ca06197deb4343108cc0af4509a0618704da730f76fd1e3bac699d809e495dbac9fa0ee7ab55184fb207dcc2b409fac0446eb87db00b8745c4865067500358552f894a03ca4ddde4c529dedc7f341f905d1c1d279f0bcad84de437efa8c02821936fb0ba0adc18e4bed7a31e3959161cc95264cb49a63912817b28d809eb26f1979327e7ca0e836baf67034c573a6dc858a2af3a8484ba34628528af23c110f984559c9b3d6a0dc7705d30cbf06cb70fefbffbda8cdc9ed4e427e1044b99909b88702ec892f1280","0xf8f1a00fc037475019567a9494d8c518c4e715fb94815b621c4985d0be2ba621079d5e80a0376c21455e95aeb8bbc1a71a4fd067f28fcbc4d15425139746991bd00d0fe8b280a09c3faad60b86ec6e1261834f868922df065d5530ec3de04f89ae867c030ed6a680a01ae221ed2039ecfdde19d66fecf97963041e17a5610ab2aa75dd3ff0e5a6a2f48080a0cff6057866aa9cb5d33b008d2225be8d94badf6dce3f1a3a568f29031f687b8880808080a0f52b36c66c019c0ec9fbed18281a837aea7a77a1a2129b8a804a00e48d718b29a099f188088c9338fe70125c05417c6a6109234b4f75d89f9b652955d6cbd6f41780","0xf851808080808080808080808080a0bf160cb5d412ac51aaab38102ed4a3e642e84bbb6ea7ef16a85fee6ca3ddaea780a0acbfbae5393615847e1b039a42d544adde87c52b9d98523640bacf4a0935571a8080","0xf8419f2094275d2782da6748b94922bbcd1c251ada014f58c11c9e6fb131ceafa97ca09fb93cdc2c48e0574cd27a2fcb580843fc6c3441bcbe467532a9c52aa6055460"]}]}`)
		value, _ := hex.DecodeString("20000000000000000000000000000000000000000000000000000000000000023d20000000000000000000000000000000000000000000000000000000000000023d1434ce2c4c370a6f7bcda9a3c44fe4ade7f851f72e01000000000000000362746306756e6c6f636bfd1d01226d6a456f79794350734c7a4a3233784d58364d746931337a4d794e33366b7a6e35379872000000000000f15521023ac710e73e1410718530b2686ce47f12fa3c470a9eb6085976b70b01c64c9f732102c9dc4d8f419e325bbef0fe039ed6feaf2079a2ef7b27336ddb79be2ea6e334bf2102eac939f2f0873894d8bf0ef2f8bbdd32e4290cbf9632b59dee743529c0af9e802103378b4a3854c88cca8bfed2558e9875a144521df4a75ab37a206049ccef12be692103495a81957ce65e3359c114e6c2fe9f97568be491e3f24d6fa66cc542e360cd662102d43e29299971e802160a92cfcd4037e8ae83fb8f6af138684bebdc5686f3b9db21031e415c04cbc9b81fbee6e04d8c902e8f61109a2c9883a959ba528c52698c055a57ae")
		param.SourceChainID = 2
		param.Height = 7272743
		param.Proof = proof
		param.RelayerAddress = acct.Address[:]
		param.Extra = value
		param.HeaderOrCrossChainMsg = []byte{}
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), native.GetCacheDB())
		_, err := ethTxHandler.MakeDepositProposal(native)
		assert.Equal(t, SUCCESS, typeOfError(err))
	}
}

func TestProofHandle2(t *testing.T) {
	ethSyncHandler := synceth.NewETHHandler()
	ethTxHandler := NewETHHandler()
	var native *native.NativeService
	{
		header7272834, _ := hex.DecodeString("7b22706172656e7448617368223a22307830306631323363393163666637376333646231623037386162313236666236333331653931336665396463623437316439353239353933643039323464363137222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307834636366623330333962373864333933383538383135373536346339616435353962616661623934222c227374617465526f6f74223a22307866663130393263353736323836666431353636353130643639393334656235663637393230633263373034313962663133373736363135363331393037616338222c227472616e73616374696f6e73526f6f74223a22307832393737633531316564613961383461333437663032653031636132386464353662633632336431313537303364366565313130376236616432386333643762222c227265636569707473526f6f74223a22307861326165663133646636666236316562393061373034313132326561343638346538653664366261396137393438633532366261313030653866643131666337222c226c6f6773426c6f6f6d223a2230783030303030313030303030303030303830303030343232303430303030313030303030313030313030383030313030303230323030303030303030303030303030303032303030343030383030303030303031303030303030303030303030303030303030303432303130303030303030303030303030303030323830303030303030303830383030303030303030303034303031383038303130303130303030313030303030323030303030303030303030303032303030303030303030303030303030303030303230303132303030303030303030343030383030383034303030303030343034303430303030303030303030303130303030303030303030303034303032383030303030313030303030303130303038353030303030323130303030303030303030303030303030303030303030303030303030303030303230303034303030303030303832303030303030303030303530303030303030303030303030303030303030303430303030303030303032313030313230383030303030303032303031383030303230303030313034303030303030303030303030303030383032303030303030303030303030303032303030303230303030303130313030343030303830303030323030303038303030303030303034303030303230303030303830303030303030303030303030303034313030303030222c22646966666963756c7479223a2230783332343337323132222c226e756d626572223a223078366566393832222c226761734c696d6974223a223078376131323030222c2267617355736564223a223078313130613933222c2274696d657374616d70223a2230783565336264653137222c22657874726144617461223a2230786438383330313039303938343637363537343638383836373666333132653331333332653334383536633639366537353738222c226d697848617368223a22307863363962326265303236653636393533643733303161623664663232356164633861616433303165373538666266613136303635396233316266313734333230222c226e6f6e6365223a22307865623938623836303031653135393264222c2268617368223a22307864393264626363306138336338356235333033633037393536386139333230383162353430653139343936633832636262396233613761666436366432626434227d")
		param := new(synccom.SyncGenesisHeaderParam)
		param.ChainID = 2
		param.GenesisHeader = header7272834
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), nil)
		err := ethSyncHandler.SyncGenesisHeader(native)
		assert.Equal(t, SUCCESS, typeOfError(err))
		height := getLatestHeight(native)
		assert.Equal(t, uint64(7272834), height)
	}
	{
		header7272835, _ := hex.DecodeString("7b22706172656e7448617368223a22307864393264626363306138336338356235333033633037393536386139333230383162353430653139343936633832636262396233613761666436366432626434222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307863346336346664333361363963393863386235633962663866336334353365306637646361393835623264313332346431396439623139343937306130656161222c227472616e73616374696f6e73526f6f74223a22307832363633393661643730646238386538643961336633353564303937313232313130663465353762373739643333383833306137643765613466323630363634222c227265636569707473526f6f74223a22307839653561613337633531313863313563303534663266643430636262646437326165633034396530396534663137346264303363616435633665396431366630222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303830303030303032303430303030303030303030313030303030383030313030303630323030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030303030303030303030303030303030303030303038303130303130303030313030303030303030303030303030303030303032303030303032303030303030303030303030303230303030303030303030303030303030303030383030303030303030303030303030303030303030303030303130303030303030313030303030303030383030303030313030303030303130303038343030303030323030303030303030303030303030303030303030303030303030303030303030303230303030303030303030303830303030303030303030303030303030303030303030303030303030303030303430303030303030303030313030303030303030303030303032303030303030303230303030303030303030303030303030303030303030303030303030303030303030303030303032303030303230303030303130303031343030303830303030303030303038303030303030303030303030303030303030303031303030303030303030303030303030313030303034222c22646966666963756c7479223a2230783332343962613830222c226e756d626572223a223078366566393833222c226761734c696d6974223a223078376131323164222c2267617355736564223a2230783362376338222c2274696d657374616d70223a2230783565336264653163222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307833346466643933326130313065363336376162653638626438376563653034303763353731323133383333663331383130346664656339376363353638663864222c226e6f6e6365223a22307832623761663433336135303562393330222c2268617368223a22307831336262623537653432383238663833303635636237623464363831313164326564356637303730623839336532646238643861386639613930666536373065227d")
		header7272836, _ := hex.DecodeString("7b22706172656e7448617368223a22307831336262623537653432383238663833303635636237623464363831313164326564356637303730623839336532646238643861386639613930666536373065222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307838363134663565353565653766663038336163333261396134663237316333343130353336326432383833383161616161613832643464643063636437333438222c227472616e73616374696f6e73526f6f74223a22307862333834336364653836303632626265623162396365653534383965353166643265623031343432646464363236653030326230353737663263396537386361222c227265636569707473526f6f74223a22307837613230333965303630313362313965396664316138663465343237353430326666383265653338613732303331333938306438313163383864303262383238222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030343030303430303030303030303030303030303030303030303030303230303030303030303031303030303030303030303030303030303030303030303030303030303830303030303030303030303031303030303030303030313030303230303030303030323030303030303030303030303030303030303030303030303030303038303130303030303030313030303030303030303030303030303030303030303038303032303230303031303030303030303030303030303030303030303030303030303030303030303030303030303034303230303030303030303030343130303030303030303030303030303030303030303030313030303030303030303030313038303030303030303030303030303230303030303030303030303030303030303030303030303230303030323030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030303030313030303030303030303030303032303030303030303030303030303030303030303030303030303030303230303030303030303030303030303030303032303030303030303030303961303032343030303830303030303030313038303030303030303030303030303030303034303034303030303030303030303030303030303030303030222c22646966666963756c7479223a2230783332353030336237222c226e756d626572223a223078366566393834222c226761734c696d6974223a223078376131323164222c2267617355736564223a2230786631366363222c2274696d657374616d70223a2230783565336264653165222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307831643032373062623635623766373530386466653333613739623162396338366434313635323736393264363034636230306364373463613164663132646265222c226e6f6e6365223a22307838353561613936393236306534643430222c2268617368223a22307865633139333135653536366234393163353133353634666363613338313563656265363337646366316432636334653664383534303039346338313330663230227d")
		header7272837, _ := hex.DecodeString("7b22706172656e7448617368223a22307865633139333135653536366234393163353133353634666363613338313563656265363337646366316432636334653664383534303039346338313330663230222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307839346163383463643866346563373639363466663664306363616234633265663365396630343162396132626536313766353530656131626230626662366133222c227472616e73616374696f6e73526f6f74223a22307837353436653332356430633563623338333063636533383530626565316132356230666233613037363035626163663333353435633537386262306331373934222c227265636569707473526f6f74223a22307837646661393762363637313965336336323762383566333533393137386663616665623138356331333237303264666162343230383963363433663435393262222c226c6f6773426c6f6f6d223a2230783038303030313031313230303038343032303034323830393430383030303430303030303030333030383030303034306130303030303630303030303030303034313030303032343031303034303034303130303030303030303030303438303030303030303430303030303030303030303030323030303031323830303030313130343030313030303030303030303030303234303038303930303030303030313030303030323030303034303430303030323032303030303030303030383530303130303030303230303332303038303038303232323034303039383834303030303030303030303030303230303030303030303130303030303030303030303030303038383030303830313030303030303130303038633030303034323130303030303030313030363130303030303030303130303230303030303030313230303034303030303031313830323030303130303030303430303030303030313030383030303030303830306361323030303030303030313030343030303034383230303032303231303030303231313030313030303030303030303030303130303430343830303030303130383030303030303032343038303230303030303130313130343032343830303030303032303038303030323030303034303030313030303138303030313030303030313030343830303030313430303030222c22646966666963756c7479223a2230783332343336666237222c226e756d626572223a223078366566393835222c226761734c696d6974223a223078376131323164222c2267617355736564223a223078326365343764222c2274696d657374616d70223a2230783565336264653361222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307834633832343237626564663937636130626231363839643865646237343139616138633661393932363135623235316230646635623231393931323632313732222c226e6f6e6365223a22307838353561613936393239316636626239222c2268617368223a22307861393133353530623065333362353035663066306265646330323831326463643935323737383834666139646534356630616262363463653633396166633437227d")
		param := new(synccom.SyncBlockHeaderParam)
		param.ChainID = 2
		param.Address = acct.Address
		param.Headers = append(param.Headers, header7272835)
		param.Headers = append(param.Headers, header7272836)
		param.Headers = append(param.Headers, header7272837)
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), native.GetCacheDB())
		err := ethSyncHandler.SyncBlockHeader(native)
		assert.Equal(t, SUCCESS, typeOfError(err))
		height := getLatestHeight(native)
		assert.Equal(t, uint64(7272837), height)
	}
	{
		param := new(ccmcom.EntranceParam)
		proof := []byte(`{"address":"0x8d069f5a5b877d9ecc5ee28715982c12f3879414","balance":"0x0","codeHash":"0xd5415eb1d2e74e08407476508707137c7e35dbf42995dd07e273c83b4c384c9d","nonce":"0x1","storageHash":"0x452a52b29d5775e923ce1e23e09a6627fe9885c0a1e6767063985736e3d13596","accountProof":["0xf90211a0b2e92858a4226ea5783e2aabb6ac29445bca323274ac68d2db5b3f0e34d46faaa07c6e127661672ae35ccf3a2e3ba9b3b9284c7830fb342a3bc2d71bcf1e02ff8da054c3b7356c2779c0eb5ee068a5837cd343e82dbc9e93a221b32d6d948fbe9f2fa0cc1645574cc7e26aff055da63b9db80c7b3ad67a0aea71fec392b3116ce548efa01c9f27af500eacee932154914d4d233fac1e65036ffbd591f14a1b661d69c593a0dcb2c98e037e110f51d5722ee96bc362c240a2aa21e713eb621166ef3401bd67a0bbb22f175f6a540663bad74c1be60688176346483d8025b1bce29430f3e5a918a0a455551dfaef8497a923c2fa65aa72924e785d7a9d515029d8365fb163673b04a00ffe99251a545da7adf3bffa74a6eecfc31ceac085ea70e84460f95cdf9155a6a0c1e7d4c063e813ae121a5a8b96dd31692007e62e468086e553d355380b96b1b8a043fd1005af7ff1d48055b7d6491f510f49b93aac826265ad81bbbd77b10e8c6ca09cab4fb1c99e78ef098ced375a0d5148844249abcb08d803abf415875dde1222a05ffea11ec992b714ba3d8edf04ecfab1b81325d63ddbf95717dedd878599081ba09f4451db83868d1c860d5bc01ae6b9397e53c80ab07211ce54a46306d8908b4fa0e45439c5b8c0995590438bac8d4cdfdfd709020eac597336be062b3a9df7aaeda00a135467e3bff0eb309d5b7cfa396ee391abab0526c60faef29a47de7f5346af80","0xf90211a0390f19abc088428c70238f0ad05cfe6b07ae6c064afb76cf651073f0cf7b893aa0a495850ff07623a35fe9feef93f37d42316b3d13ce76ed73c0d69a488852c728a01495365fee47c612d7e536ce4efc3ef1c9faf285d711ef5e3691fd19e595076aa085d2ef9200d189878fdc7266ca1d0677bdff0e6446c89089ec5fd35322c82fb8a0841d67bf7125d4b3c402521e4b1db545734a8f591d8c347d30287a8e6d8a1190a0c5ad558a8b92070b66529a5c94a9b6175a415f79b4dcc436700b36ff2b6b4857a0b8e96e9edac811a07afa9f2d1b2a3bb3710d02577437b55f0a3fc2a28d96d2f2a0c18ddcaf6c0a7d6f1b814a56a8c70736f9e3488488d46d9ccdcca5e32f2325e5a0fabb5f607b5fbdc69dd5d128ebed170c8fa9e8096668d174c1df0d80410c0222a07dd6ca35ce2491f2c0be21c93babb162591b7862e803e946afabb19b38914610a000852f4196904e98f563f631eb6825748f773569924d8d723e8dd78e8367c458a033ffe1186c9408c86bc1a8645527571d10dbe553236b7062552c3a6874bc2f33a0efc82f6a7e29f577fae5b1f3143c310c02dc1ebb2e4cda7a1775634d803be277a04edc0bf16250569c5bc35370933cdfcb99ecc1c88739beafbb5b0b50477cd405a00a76e2aabe31ecc19eb01d794d2d36ce9ac5b2647d2c8ab8f5c2df809a5fca6ca0155333d1d232d9a01701f55230e40a4a3533495cf6c7a9afba1df61677172c8380","0xf90211a048597c68f27f42e8266982f2f8cfc0f91618646f1ffb58e053dcafbe285dfc4aa07cdffdb2e9e5bb5018b2b559909b1b9350d146c7322fc3b8a7e22b5fb28c8f31a0232f828236107d8c89bd09672e952488c4807c8284775351f86a0d5254c68808a0efef2d927e3ab847994bf3700b699b126a74ec476e1171f797460c275da9577da01c19972ad5e3f2c6a144fe76954406a1eec5318bcf14f4d280ae28de29d67172a0cf409ea1fdcb7ace51b35696ff6530d2d60824e3675c8911c7bc9bd3fd4363bea070e34b07d6a88a7aa2058cee3f3cbb02e9b2d18ce2ed34698ea0a72891921a40a032bc787b47e42486a92bab2d09fc4b094c0862fbd0b86dae6f0022ee4a3b5d01a0eb54a52e14d7db343526cc37ee048bf2d6b4ae3785bdd2229b6d685fe819d79ea00f2ad0e4c40ea12d65f2504c05949023d19ef7ed3d95e712cfa7c915319b304da047c6ea45ccbaf02f1f57136ce81ced5d885d760de0a1628175311c5b77c232b7a03996331f1770f32d05050ac62177693f5333949a5b2427d1897c3f6a69f2f2e3a0b7cdd565179e6b11bf473e907f47ca56eb79513dc7b9b46b907c2798a9ea6e98a06940b8505d95090f908ecf8354f78b0e68eec84d15ea5672a429b50876cdea84a00fca72a9f8a6f5446a7ea2b805bf4872f373de66cf98e565f12dee5ed7329cfaa0cbc1967cc563439857ebffaf1bc181829cef5d5ebf45762d8bcd112773f3bdda80","0xf90211a08825c68941c4ac52fb1708078d3455d64adb2d6041eb13da4abd6a2fde25e2fda04118c05fdf1be1b5509a0c992f0b7b6b18f11a32fa8eba15c8cc1554c21f0da4a0eacf346a8d0601b97063c27df668ef26bfda5bc53c0083350c3a53fb75e5add9a0ab9864907769fd39f8c4dba7d76c270649ea5ca0111e617b6638ed65185733aea0a17734b977763c500fc3d7682158afa66cdfb5873eb3c74aec542c7dd03d9586a07406cbf145d5fc56bd2eb34880986e266d518272f3e129634d24d2b734599ce7a0787f885a477b35102416253d1a9211110f0353db7c50223729371afd20ea8174a0ba1621c030abf1f75ffc52a334d208b22e1102917f3afdefc5d867d55314b9dba0699a40e9cd369f28c059280fb854326684dedfa75f3480187e8c387411f948dba0e72962eaf57cfcd67b3c74eb54b705f82f04bb447673c01d385ec01d5b1e1baba0631d8043dae7633e9ab7b95fb4ec40f768ba59858d520e0ff3962c5dcd15300ea0f88cc4478e6ea0012866adf76b5507679c9cc598efea9a7c5d6805d3b8be2c54a041b5ae344e6c4ed6449e1f5493313f6faf2298c75c4645191962a15e3cf71a41a0deadcf39287069cb88a1e58ea22988648bcbf1b562a4e27c31db6b4faff02f02a0f9a0dbfdf1b23df52eb4be9a6598ef6cf698ca57ac93bd370badd66fea8106a7a0833c148770bbfd9166ef7ff046062bdb51b5407614f3f417084b5ab35310851880","0xf90211a0c423763462f31f12c0e32181601e76dfafadf44bab89ada67570d43dd7b88862a0f0598e24ce6df2c89661b8ed63424e1014ba21c664a8fb7d0ba83d8d99bd53f7a08da8c8d66fa171ce6fa4d3c701072ded631c0708580727f8ab676f8d3f82947fa01f45118988e3315c230ec4e23252b94050aa816238f3fa9f851feb596166c97fa0f1344000f147fd5049433321a125ee30070e74a304d1845ea23077afc2054241a02247602172797f0f106b4a15a91981cc747c108e9a479c893edb30b64232c3b8a0ff46da37205525038deccfef623d3fdd85ca73484c8e0832cfc89547c6962a52a0d372f69118c5939534627ea6d4f32fe080fd18dd1e8ddf3a2c27c515d51518ffa04c7a6b2e5fb7d545ea92fe128320e3c2545147a4cf64d16a1a88d4369cbba608a09b9de9fbf4595d4a5ecbfcb1384a51397c6f4d519befe13148d3f49aba8d1659a0e8f70574eae470bfe3edc8983ea9fcebe82151edeb1d3d2d14dffda93c7ad8b6a071b3caa47a51d29bc62a14bfec2ef82444fdcb38a304f3416e97f56b9acb1e83a0bdfb50a24c2fe4cfba92ac3bb176d764ecb306f1fa812c183a82eeea3fc39a18a0c53d014d235ebfbf41b3108bddca048dbcbae4fa1530b4c571370883c81e5af5a0e7c0f349d1346dfa3d8bf54cf86dac87c31829a3b7dce889fb74dced3041cfdba0bac0f43b139479c08a92203bae67d77cae368e1bf3857dd2d038eec0978f138280","0xf90211a0deff2c78facd67bdd752adfaed2d1bd785122e30fb9b831bd815417f0292baeaa066a94cc4537bbfc07d4c8df80bc1eab9c51c7c228a1aa84f383074f098dbcf9ba054dbc3bd1c18ea17e0175e16358ad7e30de3e3c587147a6ac35ded187b59fa53a0b9f37a7c692b069f786d4c251d6092918657a0ab80b7e342da77741f9169ab09a0bb3ae6c0bae28ed8c32b94712de09a5faa48aa52b6fb1972eb5ff6a20d05cfe7a0cf3eeaf40fb8bc2084c04e5db06a6ff5083967ec7c3b50f6b610c5fe7ef4b074a0c4a44c5a484ce35240af24aa25a6f6d730ee0326231a898248cbc63884604387a0d718c7d24ff060799e644104035c6959bf80e7040decabaaff05b0bd062a811fa0fd92444f43da243337d6efd923f55e6a4602d905a1d0767882eab59abd83f40ca0d0128a60d2b3433a1710c2530b09226c6635fa8469abe651bbfb2f69cbb31150a0c81ff500df29c6eb34e77d9249a68fafb11c1fab9a0c612c34599e4e0a99c783a018befafc88076ed909d12a2eb2b12a4be09829e663f57a0c6cc6707aa94c6e7da04d3f8f50c468843000ca435a47ceb4f926e94321f74cb4dce5f4b34efffe85dba0180349f996985ce0a820d35bff94185e2e5ca7e14ad6b5515da5e2443ec644faa07ba8664c88dbdf5ba34016550a23a1e40d9f88c03a1081c7296fe142006afa26a07750aad81ec12bb52b22af86642d6017175e2ba8f9cf9cb0b4e09535c072cb6580","0xf85180a06e97c36cf195fa678f7f695277503ab690134f834ae17b0d8b34ca8afa4a89788080808080808080808080a0f60803ca53282fb28312d69ae9bc3dd29f0e131a19da8591b2382b7fee200219808080","0xf8669d3492cbe0c4cc38b98898c3be4350da6c91ec0add9503273a55901cb4c8b846f8440180a0452a52b29d5775e923ce1e23e09a6627fe9885c0a1e6767063985736e3d13596a0d5415eb1d2e74e08407476508707137c7e35dbf42995dd07e273c83b4c384c9d"],"storageProof":[{"key":"0x421533690a8855fd21d5274bf2e833a8be4439f76c078863e3fba1cfc3f8e596","value":"0x603904010f96b89d9fcd1d1a50c9aecf1defdcad615c34afded186bcce9acb","proof":["0xf90211a0c6432ab9d5b4905f5311b36d28d11a75f4f44de5fd58cd30a9970cfa39a3554ea0b3bc6379fd0a445c3419c997020241f1070e663b7cb08e4912c8950aa8666acba03987c64369368ffce7bd5ffc75d61c1cda457c7bfd92abb60eac8c67a1200ea2a0b7070e65efadc79afa185e4a5f452a5f9897f50eef825094b6b9e53a9f9383d3a01bf2d20d3805b2443ab807c77802354f33bcbb1da7cf2de2c839e8a408e4af00a06825de041a282d305e5b68fd2baa43a5dccd303a8c037914775dd7914258891fa0c137a10c0c6fa2e341e026e08f776f5b39ebd2b99adcb6872c3827d1c1ec246ba046bee280ebde9f947e85b2e45af3274093eee4db2e476a623d59fa0f16bca418a0800f859ad1df88c2df6aea12a76f637ca8340b3feaf58582aa41707b59895e64a05c0c5685a9a5635a9647a45cb317b0235213252cc5654a38d0db53b153a33ab2a02a5cbcc764144d3f7b8b62f8e13c945442eb4ba8fd9bb7f1d3e9cd05840b5f88a01eec1af4e200b6829bce04168ba57b6530b68c889c7421d5d02ffe98678269aca067176f02855cf456802c3b035753d095f93cacafdddbc45255bbdcc201ed7290a051f25b3b2c57601c1a60d65aeabe50f009eb0d8113d8069eb2cc3c6b47e01b26a05fa2f127a0383c03f9d390490ed9cd579158142647bf1086d3c412e42bef018ca0f948471dcf309b8f640d1e9fea7bb610a5a1d2f269d5d769ad05491032c5afa280","0xf90211a0b988f776f7af29e8aed233ee656e5fbe92837376d78e56c95230a9f3bbf90f44a097a7cd327b329d9db83823dc1c408b16d0f5931cffa0b2dbcaeb55e3472df979a0181828d2f2a2688fff75d7689e99fd509fe7db10352e165bcdb70622da300c38a03420749ae182a88900b81f3d442b98b5df50f9a8eb66550af8f5c18689e95adea0eeec20f827b6399e4271d873553c0e75ad42d32bf808e029973e52e4565dca02a0c6799bd9fb207b225ecb340fc2a7a6c7e5f647a93496ced2d2c72b24a2da1511a07bf4c8c66dfd3bdef1ed1042dcc189b1bf02e52756cab24e1dc0fb4bd18f3a12a0ac39588dc1d6cb71b0fabd309c52897682dd0b02d8883474361dcb81ec213063a0e91377d53a235828ef9c0bed36eb75981ae59c0859621896dc4e6848203d51d6a04ae5e555504dc1d5eca8de2f679a241454329bde4648eafa4ddf5ea73f31f6b0a08b89e13f77acde4f54c0cd5482045bb5e33bcfa52d7ae285b31dfb8a58a1885ba03307645326e336d94d7c5eb7f856c112725d42706aee6d18bb1d5384c67217dca08671457753cf1fe27ca726b29c9de07d39b2a6e3a834a94cd92b398e7a45b2bba004df4b7d4051834f8044b64f4c67c0c32abaadae09d4eb256d6ea55a09242939a02396ab160c3a7b0915192e9e56ef5add9b8665bed1a1641ed3288f4811399fdda0235540f28dd8ba2f5b3e64f209d0ead6124d88d3083fd1275ffcf08ec276dc8480","0xf8f180a0a980475ed74296d134fee7e5b34b33631f2c1efdcd18128382b79b72cd5a296f8080a0bc6562260f376d444c5ad54e87e78eb408d15cd56dd5a3b94db5c4eec6152d63a0784c261192ffc83419316c0065580b3abd325bb6201d61a79c5a0ab512c1243580a033139737dbb76a4c66de93d9ea904f25f72fd2b29cdf3ff327810ca4e03b3931a04d31c5303500a50c5aac00538c70e475d079c77c3ac5aa4c83642bf13faf65b980a0f9f172a0ef8a793140793c7899bffbae4f0e36a3c98e5c112e5899831164da398080a08ee7d57a366649f19d0bfd2b26e7210b960ee00d12bb434a636e726bd07e4e5f808080","0xf851808080808080a09b89f84e964cfd303654ff2dfbff7a904d6c509c0eb81ee6c010ef8af692b2998080a0263400d58008c81f3143f9a82fd3c7cb681b2efd2740092a5c8c87a7490879d580808080808080","0xf8419f20eba2e7e54d8acdc0f98c486152dea1818a47aa58529ed664c3488c5ab5cea09f603904010f96b89d9fcd1d1a50c9aecf1defdcad615c34afded186bcce9acb"]}]}`)
		value, _ := hex.DecodeString("2000000000000000000000000000000000000000000000000000000000000002662000000000000000000000000000000000000000000000000000000000000002661434ce2c4c370a6f7bcda9a3c44fe4ade7f851f72e01000000000000000362746306756e6c6f636bfd1d01226d6a456f79794350734c7a4a3233784d58364d746931337a4d794e33366b7a6e35377367000000000000f15521023ac710e73e1410718530b2686ce47f12fa3c470a9eb6085976b70b01c64c9f732102c9dc4d8f419e325bbef0fe039ed6feaf2079a2ef7b27336ddb79be2ea6e334bf2102eac939f2f0873894d8bf0ef2f8bbdd32e4290cbf9632b59dee743529c0af9e802103378b4a3854c88cca8bfed2558e9875a144521df4a75ab37a206049ccef12be692103495a81957ce65e3359c114e6c2fe9f97568be491e3f24d6fa66cc542e360cd662102d43e29299971e802160a92cfcd4037e8ae83fb8f6af138684bebdc5686f3b9db21031e415c04cbc9b81fbee6e04d8c902e8f61109a2c9883a959ba528c52698c055a57ae")
		param.SourceChainID = 2
		param.Height = 7272836
		param.Proof = proof
		param.RelayerAddress = acct.Address[:]
		param.Extra = value
		param.HeaderOrCrossChainMsg = []byte{}
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), native.GetCacheDB())
		_, err := ethTxHandler.MakeDepositProposal(native)
		assert.Equal(t, SUCCESS, typeOfError(err))
	}
}


func TestProofHandle_HeaderNotExist(t *testing.T) {
	ethSyncHandler := synceth.NewETHHandler()
	ethTxHandler := NewETHHandler()
	var native *native.NativeService
	{
		header7259461, _ := hex.DecodeString("7b22706172656e7448617368223a22307862323534646537333339313834366561343439393066656233336464633266333236303337653232663130646165353939633533646537626363623565616636222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307832373764316465343036313662626363356232653535333238363063646231613332376565343263356135363934363865333835363738316563363663636333222c227472616e73616374696f6e73526f6f74223a22307835303735383837336631313030313861656363366533656564326664386163633761393162343134316338623263373866306665643536636464306532343231222c227265636569707473526f6f74223a22307861613331363939373365666263633233323330376663613266386363393965653833316533623665333431613134393135633130363739303136656665313462222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030222c22646966666963756c7479223a2230783331616235653166222c226e756d626572223a223078366563353435222c226761734c696d6974223a223078376131323164222c2267617355736564223a22307837623365222c2274696d657374616d70223a2230783565333932386133222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307864333663656666636631303036643334626533316337343764613235316335336663393165333633623563323762323631613364353434343530396230613135222c226e6f6e6365223a22307838353561613936393133323963323764222c2268617368223a22307836353834356566633832366366326238363863346462663232363633396534616364346161643933656263636462653162373035663432663035393363333364227d")
		param := new(synccom.SyncGenesisHeaderParam)
		param.ChainID = 2
		param.GenesisHeader = header7259461
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), nil)
		err := ethSyncHandler.SyncGenesisHeader(native)
		assert.Equal(t, SUCCESS, typeOfError(err))
		height := getLatestHeight(native)
		assert.Equal(t, uint64(7259461), height)
	}
	{
		header7259462, _ := hex.DecodeString("7b22706172656e7448617368223a22307836353834356566633832366366326238363863346462663232363633396534616364346161643933656263636462653162373035663432663035393363333364222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307831623138326132383831363564626662626361633661613137333361336130633866393062663538623133626332616666333533323432396164366637613838222c227472616e73616374696f6e73526f6f74223a22307865616336616533356562306639396336613133306264346465333661626534376464613932336266653365653833386236666135333865303534313730623962222c227265636569707473526f6f74223a22307831396561393430653166653936373239303930373565383066623332363665343235653434396662306662313061666166303737363564386261353261336366222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303031303030303030303030303030303030303030303030303030303030303030303030303230303030303030303030303030303031303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303034303030343030303030303030303030303030323030303030303430303030303030303030303030303030303030303030303030323030303030303030303030323030303030303030303030303031303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303130303030222c22646966666963756c7479223a2230783331623139333861222c226e756d626572223a223078366563353436222c226761734c696d6974223a223078376131323164222c2267617355736564223a2230783765373565222c2274696d657374616d70223a2230783565333932386135222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307835373133363435343765636632343630356565386130326438376366646462653736386662353936396639356235646132643333623339356137316632656532222c226e6f6e6365223a22307832623761663433336261613737306636222c2268617368223a22307839326231646136643062313039623239343534653632653431616231613235353863666339663661363533333861666333613662333166656161636363313533227d")
		header7259463, _ := hex.DecodeString("7b22706172656e7448617368223a22307839326231646136643062313039623239343534653632653431616231613235353863666339663661363533333861666333613662333166656161636363313533222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307830663538353965653239346462393134373662623731376338616661313233373235663665633536353737633237656266386434366533323166326561336437222c227472616e73616374696f6e73526f6f74223a22307862306537653339323434613863313736356638633361653565303962363766353464373962393339653335386333613961653864633532316633643164646537222c227265636569707473526f6f74223a22307866316361393239393938643738613035333131616639383137393166633338383135656263643036376563383965623735343733616566316338396130663264222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303830303030303032303030303030303030303030313030303030303030313030303030323030303030303030303030303030343030303030303030383030303030303030303030343030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303034303030303030303030303130303038303030303130303030303030303030343030303030303030303030303030303030303030303030303030303030303030303230303030303030303030303030303030303030383030303030303030303030303030303030313030303030303130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030343030303030303031303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030323030303030303030303030303030303030303032303032303030303030303030303030303030303030303030303830303030303030303030303030303030303030303030303030303030303230303030303030303030303030303030303030303030303030323230303030303030303030303030303030303030303030303030303430303030303430303030303430222c22646966666963756c7479223a2230783331616235643538222c226e756d626572223a223078366563353437222c226761734c696d6974223a223078376131323164222c2267617355736564223a223078373966653031222c2274696d657374616d70223a2230783565333932386263222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307838623638653937613336616437336566383437336365343636643932633634313339396532336364393032366561336539656465613835343035336131343765222c226e6f6e6365223a22307838353561613936393239326336653362222c2268617368223a22307832326437336361356662626230633864376434333339623133613432343339663133343963633735633563616134633935623666336463613235343435633730227d")

		param := new(synccom.SyncBlockHeaderParam)
		param.ChainID = 2
		param.Address = acct.Address
		param.Headers = append(param.Headers, header7259462)
		param.Headers = append(param.Headers, header7259463)
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), native.GetCacheDB())
		err := ethSyncHandler.SyncBlockHeader(native)
		assert.Equal(t, SUCCESS, typeOfError(err))
		height := getLatestHeight(native)
		assert.Equal(t, uint64(7259463), height)
	}
	{
		param := new(ccmcom.EntranceParam)
		proof := []byte(`{"address":"0x4b61a4c0ab51b53cfabf1339bfdb7dfd27be596a","balance":"0x0","codeHash":"0xd5415eb1d2e74e08407476508707137c7e35dbf42995dd07e273c83b4c384c9d","nonce":"0x1","storageHash":"0xac92f34547c3928bff4b16a01d011cdd313f5c8658a0ebbc419d731fc96aed01","accountProof":["0xf90211a044cdba96ea41a639286789665321c82b82da3af44c13a23e89cd7d12489f275ba04f667ad4dd8b93125a461fa90cba9824de0cc6e463963f70546d34eb5d0850ada090b90837f8e344dffde14735d66fb53204b77d546b2d588013f669a6d7cbb052a03fdca5da44fdfa953009a1a393c92af32d4aba170d9d4a355c72d74ff3609ee0a0fb715e667b8ea2a486fa7664b6319f9ad70c8a02a8523ea66018c8a800796312a0e1b0607233b4eb726ec99b875021cd7a419dfa7db281509b09d5e0e586bf20e5a0e0f020646f30505c6dee185e2b15b69b41229f4a5ef3bd1b86a7640323267d0da04a9248c1e2376c795d7e7092f5f269112a5ef0ba9f615691752d327a2e14db46a09434b2e9ce4f7902049c73069aa4e06a64e1b4f66ad28886c1d2dbce4f8d8885a049723843c76c139ee6a852913a15f867bf6996efeab24093831448a3fd319060a0c76af527df045ec8841d3844f75c0df45413eb39e4d133bca4ef6b9f34c14e9ba0e1d251bed147df5615e73e38b5116b9613edfbd40148698ba37d8aaa4c96d08ea0f71d80eb8db1138d42e8ba10e4bbf752e63ba3a2e6202cf77bd139b1f2037909a0cd5faa98e3fb40080b58bafb07477761d5259293313bba9dfa2a717263cc2c6aa0a7da5f100c1ad5e1adc36cbe42b2a75b8e98e7f6ed834f17d2d986220c68dd0ea070e309eb14f7938217f161f05a3322e4334fd71216e2cc39f5581a4968f39c9a80","0xf90211a0bc3c4c601894a3e2e1f63e6a0cb8ded9a45f9d490a48d2e468fa1ef0f811c46aa0ba2c588cfaa0f80fbf358c3122d87c450e0c3c4f4f11ee666f8d373542915ff3a0df808f83f713ba243c4d1f8524de68c1321a2997fe8e90707199fe273eff9e80a0b271d852ef674361d567538ac385fcc3a64393b83e74ca5042a80561ea930f41a09e394e781d7456fec9c3eee07958624ded9f3dd33a7417e911d829f1b8a3fc2da038836c839d052cfac47eadc38eef898e81a141b861aae160b458dc2a810377fca08e0f1718e800fff19325f89e794371576d317ef69a42bc58a7d06bb22bcea109a0248d5e1d35531a8ae584f4748ba9f066b2db80b66988735c4a42ebe9fe840e32a0f85898019742452e3e6f13ab0eba8be413f703f9b6ddb738a8ffee3a5b6921cfa0d8911f2a5d448d870e75995b5d424040f639ba07a018813c6c3f4534b2a40588a0940046d1f708d0a435ae58a899dca8f0cc2b10ba37bfd5a8e1ea31d2a6e7f370a09cc6a3faaf4dbb3ec1c6a545f69ee5ea4be632edfd7da38005466de113f4fe1ea071a50ff6f949b9b7b39754857b10f8e988f378e740c917fbc47d07363f348eb0a0b1df183e8603fb1c3aad3af711d2e15696f256f5dd2c94bd88be390f13013762a018f2794476d5b40a054196c7f2aa218c508cd4f10a85f71222a7c08ab5cbd109a0f296cfcd6b516e9c8d2c1a90c5ddd8393667baf9b7fc37f7b403f3a26d36e1c080","0xf90211a0616b9d83bd7f96de1864f0fe3e16badf4dfa89b8f3eba721a46c7f232d930e5ba09e71d9854994874d673e049153c7accf44196a6211b80ef97b3d29e636db521aa048d549ac792bbf2e3f07a7362b81f8817193c446c56eb66b71abe7ca6fe5c6a5a0e120d0b4dadef4604bd8b9250ad6ca3ca6b11da171e209a566924950af03571ba067f4f8626b8af02a4b7a33e546a55845051b3b81cde0e045d4508908b27a49aaa0ed55c43c8d4ef28c54b641660d457d4e0956cc1c63a77a98f39dd5f1f185b98ca08ddcf649ac1ca8df725e021298352a5daf44f9a1caedecd9fef2bd509ae43c0ea00223058d54f8445d1e53e2586600db633ed9aba3f81fa9977fabde53fca4b4d7a0c39638566db5d144df1521afe1e7451ec1836ead2eda423443b66ec0e113de30a011a3c497474d46e16a1f15c3558d5043a994a7df3e4f7e68025f344e12e7de85a0814c5111d3853dcfb4b3008e983364d68869897ef3d246e482f5d51c97dbef10a04d1605e0a23e25bb985b83a0f9743e632c737336cdf7394c1a9a4dfee19a9168a031e6c9c8329cbe268f83da4e8eca50a20a95c28f15780d332625f51122bdd797a05c1fb1a5be55ecc86189fd3a9ea070ec9e4b9394618c9cba8ef47eb77488dc02a0220348f330a91580351ba1be5c36264497e75f6fc1ddf109c80e0069819347f2a0809145f936a7b913fc86edc2dd914b5c835b2b17a4fb2cafda62ca6d2440df3680","0xf90211a0bcef09832cca3e0d23f7ea55f6e605bd36141a362094e57a698fe5a086ab3f2ea067f569bf8e06758f39fc95fb312f808cad88dc7a62cc82937ea7214d43216fcaa02832f266942fa9a3f6b55d05f8e6f1408f6d82356a761578c7dae9408b7f0d50a0c75bd37f1e94fc6c322e3e5b50b3e36efaa626b457df7ecacb3b8e65fad53bbaa03e4ff0b64aa60e9ea8329cadb49ba89f7cad0c541d525956b7484133aa973979a0d32e95abde9c3278cf4e7a16d4edcde194410ae0ce8df4ff78c5441236d53837a07703f8673c8d74beb4e639d0a4603b9026e20fea0c6547eda433df2d9b53dc56a0fac583c68287d294eb76815bb4841b992187add002f0e563b891e71d157af33aa096c85eaa274319ced0ead3cd0054563b59a2fbf750542e5029b83a5a5ded67e2a00cf31256126ad966492d04f22dbbc70880a5dbfcf3d795842b1a1fc36684e419a0359a1ab3ca5de3682cb57bbf0d5c9959f6c964e0f7c0e99580de14108fae6d9ca03e165d0a6c4d7e02bf4f459188eb5a0ec51ee3f960eaec1a8d9efa4a25e2fd25a031444ce52cb0b9d698f314acbbea8b98ca6df2a789ba35f1af64b07989659ca7a0b6e6da13a8361f323f7391facc8a20c5af184c8e345ab2396c94c868f420653ca0259dbbb9fed067946c475cfe4919ca6ac8f089fc61aa7fbd76f3b9b8f6271617a05b2f4edce7b144f1f00fc61539ac43b772684dc1953ad3a885630cb351fc257680","0xf90211a002e5af012079123236fdb908236ea6aebaddff546e2580424101a23211fbde75a003fd741237eb90196f5822f91888074b2180d250a8ff48b41563cd94a817becca06233754ce9b2df7e1ad659e5515b042fe9007f76274f38df178ade77f5b74440a007f4b142b3b9599e91052f14872506bb1bee0b7ee70dc242d19268a0d0eeaa12a0a0b5f6499ae2ef83a1be1e3d73e4b88b3d322911457e97abb42a23758bb351d3a08e35b9b0f4ad1b5a6fbddcdacaa2463d3d4d7c8dd406ce19cd206c6595db674ba02bf200d3016a9e9eee1976618999c27abdbd63b3c5e675d64a833b1685944352a024e0583914d4ab6c6cbb5aac193b479d48ab3254ab3e88e5b6544a882dcf8933a09d7b11fa377dbf3d92f06faea40962189f388e87fad8cf0ece2196b8b30e9da4a01667268a20948d7525d576628d2ba3707a94d3b1da0ba7f28a45bba4737d2894a08c0b6a7b94d696bf5c532c613e0feb3dba82c55c4fb01134c83c319402d2b871a0026671a3a43a954d025e47e750244cf4b04a8354fde6cbea9c467368049c1feea0507b816282aefd8f3b582bd6ae7d5acb037b313debc2028e57b9cae229e1db9ca09ce3d88f7e1f321e187d1b234c2493e81b5d7b47ad6f0cb0bfd1c9ac5e5f74a6a092c2f1e2ce6ea1015f77d98c0072e7ec9b1e18406b0ba41cff9c1cdae71c9542a0b34ec209c27899ca2b1ea2d07361ea00628d28e53414dd6bfa39c39cb7eaf23e80","0xf90191a07fe5ff2aa391a7ea09ac6d55f4621aaf23cb322e559c110f3bc3c7eb3eda7a8ca0230e6812eb0e8bba2ad95edc695412e33e85539d0eab1e96968bab9f9f1f019c80a0d28dd1d2320e9e15e8bef5636e8d3e2c9b32d9c1475c78e4a435bcd3e19b812aa07a33a6998479f52a1d7c06d675a6e876c68727a61caa34e39115f03efb3afc1280a0dd4290c3837afd01faa42f458e0486bbfc4885b57b5c835f0ee6fcf55b21a394a00f07b81acd0335f3263af89f877e72bd60a5b2b5bb3e0d6d8cbf5f5f5f85ce16a0e338a2c0be8577567cb62a6d58a95d8f59a5ff1b2711f75bb31ccc094bf7aaafa0d5b82a1d9af21fee4199b9867316f027f9af7d3773e1710ce7d200a93c67fef8a023963250bd9f8e7a05e57c71bbeeb1c2543777aad8175579d4a285eb966e2cf580a0619d3a8d0f12f692c9cb482d18f6d89b9f4dc4387f1a5c3d5695a58e169c6aeaa026047caa832100fdac0ade771d2559e4b250c1ebd4d3f2c58ce3ffb8a73a3a54a0aa24cea6d585f51e7363e9188e0ceca15a2fcf8ef7b06ffb8a244e38444893ab8080","0xf8679e20a156fa491379eaedeba66e5a505622acecbf4ba5671e47f00370827178b846f8440180a0ac92f34547c3928bff4b16a01d011cdd313f5c8658a0ebbc419d731fc96aed01a0d5415eb1d2e74e08407476508707137c7e35dbf42995dd07e273c83b4c384c9d"],"storageProof":[{"key":"0x50a82f9cbcdfaca82fe46b4a494d325ee6dc33d1fa55b218ab142e6cc2c8a58b","value":"0x2d37cc264865ae01b30172c43ac9ace29ba1dee20f10aa74ce291b26689c050b","proof":["0xf90211a0b07d4dbb8e1e7f7357496c011b008c5a49531e90725e1957d769dc720fcbd8d7a0172557790331f25ff2b5aada1d25bddf0fda4ea790a40ef0e596a45fe173b1e6a0e312e10d94bd7dad39723078aba881d4235043bc3c1ab59f44cea61c0e56a1b7a04d0c28f3e08dd98e7ea6597fbe6c604592c7f2359db9bc42bf3e4b8bf42459c5a0f1562a82dbc1994119ea29a65f255eda43959309171b4606f4011cafd0173ac2a01fc25384137fa860cb740f1811cea39bd6a5c86f52d45ad6d3a00b40f60d444aa089f45efd567de9edc6a8bfa4bc8684dc4118833a51a5f20d6d7c0e719586a909a06b6d587b1aa7fc7d81a56bc9cd20d621a1772c814cccc873692572bca93106d4a03d51ba86ef58614506f4c4425eda5692e71a818171a669dcaee5ea10f3902e38a09566b3631d046edda78a244db59304ccd8cea8287d23dcd0d03a77fcd60a0c1aa097c7251c12165854304785062c881394e9eeacc9bb55dd08a9331730bcae2711a0f677cebfff0adfd030227685d7c231fc9c8ecedb8b0fa62250948ff6f895efa9a0106b34679f06a804b941370b81bb6d68e79505a387a49dcd236a0a88063aa527a0579f36e4d3ae280c83851cb791e4ee75d80d832762e95275a15c1ae33657d9ffa0b7ca9f6e6fd1d25fbd44ced8561c290c3cabbf2891b4b8289ca54d671e887430a05177446b71571d22b976133f873355c383667a2d60e1ca3ebd882854a7aac8f580","0xf90191a0525d0baab303e971a33085929b03ad88fe97a9c2ab92480a4d09720599581c11a0e783b08ecb0ae24cbcb1804bc4f422557bce71f077adf4edf7c275a745ed5b2a8080a0c310a228b83f5310ca38b83415b7113ce621743b74fbbeb907944115859dbb4ca0085b66671b0eb402d360bfe181b2cb883720167bd782bf4bbdf920998a001414a05ee03832f17957b631b15db06fa7bdf3b8f0cd1c61d27af684ca60bd15e041bca0a4dae0acbd7fe8b71b48f520fef3c35b946cdce186b76e675595ddbbedb59363a0f81d3a61a2a23dc07866ea1ccaafb4368da835809cc7159ce8703ac8ead6cdcca046d79da3f2ac115f3da3e0cb95a77e778da969b02aa20a8841907a3fd4e1076f80a0e1d17b106cd31499d9700b73d5f8b5c5bdc02835ccc0486dc9d4d0b834de8a1980a0d860e04becc55860efa5f851d389d43d40177caa56f6244e0213ff58ecfdf53aa0dbb6dfc13a9106cf6aed1840f26a4a41ed9ad97b7f87e09cc1eb10beaee87092a0e974b76e9fd2af46966cbdf4aad7fb986b68ce470a660f6ac37d393149b99dbb80","0xf843a02038fd5b02a17455a63e08ef8acf42f0c690bb3323f43c6cfc048729c3a46670a1a02d37cc264865ae01b30172c43ac9ace29ba1dee20f10aa74ce291b26689c050b"]}]}`)
		value, _ := hex.DecodeString("20000000000000000000000000000000000000000000000000000000000000001320000000000000000000000000000000000000000000000000000000000000001314662e1b7ba042f389cb1b26c4d988e137d540fc4301000000000000000362746306756e6c6f636bfd1d01226d6a456f79794350734c7a4a3233784d58364d746931337a4d794e33366b7a6e353740420f0000000000f15521023ac710e73e1410718530b2686ce47f12fa3c470a9eb6085976b70b01c64c9f732102c9dc4d8f419e325bbef0fe039ed6feaf2079a2ef7b27336ddb79be2ea6e334bf2102eac939f2f0873894d8bf0ef2f8bbdd32e4290cbf9632b59dee743529c0af9e802103378b4a3854c88cca8bfed2558e9875a144521df4a75ab37a206049ccef12be692103495a81957ce65e3359c114e6c2fe9f97568be491e3f24d6fa66cc542e360cd662102d43e29299971e802160a92cfcd4037e8ae83fb8f6af138684bebdc5686f3b9db21031e415c04cbc9b81fbee6e04d8c902e8f61109a2c9883a959ba528c52698c055a57ae")
		param.SourceChainID = 2
		param.Height = 7259464
		param.Proof = proof
		param.RelayerAddress = acct.Address[:]
		param.Extra = value
		param.HeaderOrCrossChainMsg = []byte{}
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), native.GetCacheDB())
		_, err := ethTxHandler.MakeDepositProposal(native)
		assert.Equal(t, HEADER_NOT_EXIST, typeOfError(err))
	}
}

func TestProofHandle_ProofFormatWrong(t *testing.T) {
	ethSyncHandler := synceth.NewETHHandler()
	ethTxHandler := NewETHHandler()
	var native *native.NativeService
	{
		header7259461, _ := hex.DecodeString("7b22706172656e7448617368223a22307862323534646537333339313834366561343439393066656233336464633266333236303337653232663130646165353939633533646537626363623565616636222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307832373764316465343036313662626363356232653535333238363063646231613332376565343263356135363934363865333835363738316563363663636333222c227472616e73616374696f6e73526f6f74223a22307835303735383837336631313030313861656363366533656564326664386163633761393162343134316338623263373866306665643536636464306532343231222c227265636569707473526f6f74223a22307861613331363939373365666263633233323330376663613266386363393965653833316533623665333431613134393135633130363739303136656665313462222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030222c22646966666963756c7479223a2230783331616235653166222c226e756d626572223a223078366563353435222c226761734c696d6974223a223078376131323164222c2267617355736564223a22307837623365222c2274696d657374616d70223a2230783565333932386133222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307864333663656666636631303036643334626533316337343764613235316335336663393165333633623563323762323631613364353434343530396230613135222c226e6f6e6365223a22307838353561613936393133323963323764222c2268617368223a22307836353834356566633832366366326238363863346462663232363633396534616364346161643933656263636462653162373035663432663035393363333364227d")
		param := new(synccom.SyncGenesisHeaderParam)
		param.ChainID = 2
		param.GenesisHeader = header7259461
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), nil)
		err := ethSyncHandler.SyncGenesisHeader(native)
		assert.Equal(t, SUCCESS, typeOfError(err))
		height := getLatestHeight(native)
		assert.Equal(t, uint64(7259461), height)
	}
	{
		header7259462, _ := hex.DecodeString("7b22706172656e7448617368223a22307836353834356566633832366366326238363863346462663232363633396534616364346161643933656263636462653162373035663432663035393363333364222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307831623138326132383831363564626662626361633661613137333361336130633866393062663538623133626332616666333533323432396164366637613838222c227472616e73616374696f6e73526f6f74223a22307865616336616533356562306639396336613133306264346465333661626534376464613932336266653365653833386236666135333865303534313730623962222c227265636569707473526f6f74223a22307831396561393430653166653936373239303930373565383066623332363665343235653434396662306662313061666166303737363564386261353261336366222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303031303030303030303030303030303030303030303030303030303030303030303030303230303030303030303030303030303031303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303034303030343030303030303030303030303030323030303030303430303030303030303030303030303030303030303030303030323030303030303030303030323030303030303030303030303031303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303130303030222c22646966666963756c7479223a2230783331623139333861222c226e756d626572223a223078366563353436222c226761734c696d6974223a223078376131323164222c2267617355736564223a2230783765373565222c2274696d657374616d70223a2230783565333932386135222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307835373133363435343765636632343630356565386130326438376366646462653736386662353936396639356235646132643333623339356137316632656532222c226e6f6e6365223a22307832623761663433336261613737306636222c2268617368223a22307839326231646136643062313039623239343534653632653431616231613235353863666339663661363533333861666333613662333166656161636363313533227d")
		header7259463, _ := hex.DecodeString("7b22706172656e7448617368223a22307839326231646136643062313039623239343534653632653431616231613235353863666339663661363533333861666333613662333166656161636363313533222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307830663538353965653239346462393134373662623731376338616661313233373235663665633536353737633237656266386434366533323166326561336437222c227472616e73616374696f6e73526f6f74223a22307862306537653339323434613863313736356638633361653565303962363766353464373962393339653335386333613961653864633532316633643164646537222c227265636569707473526f6f74223a22307866316361393239393938643738613035333131616639383137393166633338383135656263643036376563383965623735343733616566316338396130663264222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303830303030303032303030303030303030303030313030303030303030313030303030323030303030303030303030303030343030303030303030383030303030303030303030343030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303034303030303030303030303130303038303030303130303030303030303030343030303030303030303030303030303030303030303030303030303030303030303230303030303030303030303030303030303030383030303030303030303030303030303030313030303030303130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030343030303030303031303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030323030303030303030303030303030303030303032303032303030303030303030303030303030303030303030303830303030303030303030303030303030303030303030303030303030303230303030303030303030303030303030303030303030303030323230303030303030303030303030303030303030303030303030303430303030303430303030303430222c22646966666963756c7479223a2230783331616235643538222c226e756d626572223a223078366563353437222c226761734c696d6974223a223078376131323164222c2267617355736564223a223078373966653031222c2274696d657374616d70223a2230783565333932386263222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307838623638653937613336616437336566383437336365343636643932633634313339396532336364393032366561336539656465613835343035336131343765222c226e6f6e6365223a22307838353561613936393239326336653362222c2268617368223a22307832326437336361356662626230633864376434333339623133613432343339663133343963633735633563616134633935623666336463613235343435633730227d")
		header7259464, _ := hex.DecodeString("7b22706172656e7448617368223a22307832326437336361356662626230633864376434333339623133613432343339663133343963633735633563616134633935623666336463613235343435633730222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307836633836653661613830303566663433356264656639393736653433396434616339333866616466346231656537663031376563333664313661346131623266222c227472616e73616374696f6e73526f6f74223a22307864316635353761623865663631396461313664633266366338363165613034373737616664623766646666373763363964343462653130373165306362656332222c227265636569707473526f6f74223a22307864623563643163643264336533343936653533343762666532643764326561653534356264303466393863373330343364323165386664373065656536633837222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030343030383030303030303430303030343030303030303030303030303030303030303030303831303030303030303030303031303030303031303030323030306130303031303034303032313030303030303039303030303030303030303830313030303831323030303438303030303230303030303030323030303030633030303038303034303430303038303030303030303030323030303030303030303030303030303030303030343031303030303434303432303030303030303030303830303130303030303030303030303030303834303434303030303030303030303130303030303032303030303030323030303032303530303030343031323030303030313030303030383030313030303032303030303030303030303030303030303030303030303430303230303030303030323030303034303030303030303030313030303036303030303030303030303230303030303030303030303030303030303030303030303038303030363032303030303030303030303030303032306430303430303030303030303030343030303030303030303030303030303030303030303030323030303330303230323030303230303230303030303038303030613030303030303030303030303230323032303030303134303530303030303030313134303030222c22646966666963756c7479223a2230783331396566323832222c226e756d626572223a223078366563353438222c226761734c696d6974223a223078376131323164222c2267617355736564223a223078326562663137222c2274696d657374616d70223a2230783565333932386463222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307866643433393339333563666130343861653762653761616136313162623036383638303935326335393262383831313333333366643733323236393637616232222c226e6f6e6365223a22307838353561613936393133333264363966222c2268617368223a22307836336162343534613932666466356634363865356462393031306234633663626334636664393661386332316430353333623638386636633837313334643334227d")
		header7259465, _ := hex.DecodeString("7b22706172656e7448617368223a22307836336162343534613932666466356634363865356462393031306234633663626334636664393661386332316430353333623638386636633837313334643334222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307864663265313332303766336161623238396662393662343963363430326462303362376664396435396266663761353632363164326161393331376462666464222c227472616e73616374696f6e73526f6f74223a22307838383338303065333166303934633664356136663832613631663835316237323232353631303930306139653739626165386534323839313464636334353263222c227265636569707473526f6f74223a22307830353662323366626261343830363936623635666535613539623866323134386131323939313033633466353764663833393233336166326366346361326432222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030222c22646966666963756c7479223a2230783331613532363630222c226e756d626572223a223078366563353439222c226761734c696d6974223a223078376131323164222c2267617355736564223a22307835323038222c2274696d657374616d70223a2230783565333932386465222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307835316430396562623331616664353963626432386663373437393237313437373839343966306230353039303164306235376335396661366130343333343564222c226e6f6e6365223a22307838353561613936393137623336396230222c2268617368223a22307861656632393933313662656362663339353738616565633438333265393332303830393732313065346661646331356230383031376466363966333134346462227d")

		param := new(synccom.SyncBlockHeaderParam)
		param.ChainID = 2
		param.Address = acct.Address
		param.Headers = append(param.Headers, header7259462)
		param.Headers = append(param.Headers, header7259463)
		param.Headers = append(param.Headers, header7259464)
		param.Headers = append(param.Headers, header7259465)
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), native.GetCacheDB())
		err := ethSyncHandler.SyncBlockHeader(native)
		assert.Equal(t, SUCCESS, typeOfError(err))
		height := getLatestHeight(native)
		assert.Equal(t, uint64(7259465), height)
	}
	{
		param := new(ccmcom.EntranceParam)
		proof := []byte(`{"address":"0x4b61a4c0ab51b53cfabf1339bfdb7dfd27be596a",:"0x0","codeHash":"0xd5415eb1d2e74e08407476508707137c7e35dbf42995dd07e273c83b4c384c9d","nonce":"0x1","storageHash":"0xac92f34547c3928bff4b16a01d011cdd313f5c8658a0ebbc419d731fc96aed01","accountProof":["0xf90211a044cdba96ea41a639286789665321c82b82da3af44c13a23e89cd7d12489f275ba04f667ad4dd8b93125a461fa90cba9824de0cc6e463963f70546d34eb5d0850ada090b90837f8e344dffde14735d66fb53204b77d546b2d588013f669a6d7cbb052a03fdca5da44fdfa953009a1a393c92af32d4aba170d9d4a355c72d74ff3609ee0a0fb715e667b8ea2a486fa7664b6319f9ad70c8a02a8523ea66018c8a800796312a0e1b0607233b4eb726ec99b875021cd7a419dfa7db281509b09d5e0e586bf20e5a0e0f020646f30505c6dee185e2b15b69b41229f4a5ef3bd1b86a7640323267d0da04a9248c1e2376c795d7e7092f5f269112a5ef0ba9f615691752d327a2e14db46a09434b2e9ce4f7902049c73069aa4e06a64e1b4f66ad28886c1d2dbce4f8d8885a049723843c76c139ee6a852913a15f867bf6996efeab24093831448a3fd319060a0c76af527df045ec8841d3844f75c0df45413eb39e4d133bca4ef6b9f34c14e9ba0e1d251bed147df5615e73e38b5116b9613edfbd40148698ba37d8aaa4c96d08ea0f71d80eb8db1138d42e8ba10e4bbf752e63ba3a2e6202cf77bd139b1f2037909a0cd5faa98e3fb40080b58bafb07477761d5259293313bba9dfa2a717263cc2c6aa0a7da5f100c1ad5e1adc36cbe42b2a75b8e98e7f6ed834f17d2d986220c68dd0ea070e309eb14f7938217f161f05a3322e4334fd71216e2cc39f5581a4968f39c9a80","0xf90211a0bc3c4c601894a3e2e1f63e6a0cb8ded9a45f9d490a48d2e468fa1ef0f811c46aa0ba2c588cfaa0f80fbf358c3122d87c450e0c3c4f4f11ee666f8d373542915ff3a0df808f83f713ba243c4d1f8524de68c1321a2997fe8e90707199fe273eff9e80a0b271d852ef674361d567538ac385fcc3a64393b83e74ca5042a80561ea930f41a09e394e781d7456fec9c3eee07958624ded9f3dd33a7417e911d829f1b8a3fc2da038836c839d052cfac47eadc38eef898e81a141b861aae160b458dc2a810377fca08e0f1718e800fff19325f89e794371576d317ef69a42bc58a7d06bb22bcea109a0248d5e1d35531a8ae584f4748ba9f066b2db80b66988735c4a42ebe9fe840e32a0f85898019742452e3e6f13ab0eba8be413f703f9b6ddb738a8ffee3a5b6921cfa0d8911f2a5d448d870e75995b5d424040f639ba07a018813c6c3f4534b2a40588a0940046d1f708d0a435ae58a899dca8f0cc2b10ba37bfd5a8e1ea31d2a6e7f370a09cc6a3faaf4dbb3ec1c6a545f69ee5ea4be632edfd7da38005466de113f4fe1ea071a50ff6f949b9b7b39754857b10f8e988f378e740c917fbc47d07363f348eb0a0b1df183e8603fb1c3aad3af711d2e15696f256f5dd2c94bd88be390f13013762a018f2794476d5b40a054196c7f2aa218c508cd4f10a85f71222a7c08ab5cbd109a0f296cfcd6b516e9c8d2c1a90c5ddd8393667baf9b7fc37f7b403f3a26d36e1c080","0xf90211a0616b9d83bd7f96de1864f0fe3e16badf4dfa89b8f3eba721a46c7f232d930e5ba09e71d9854994874d673e049153c7accf44196a6211b80ef97b3d29e636db521aa048d549ac792bbf2e3f07a7362b81f8817193c446c56eb66b71abe7ca6fe5c6a5a0e120d0b4dadef4604bd8b9250ad6ca3ca6b11da171e209a566924950af03571ba067f4f8626b8af02a4b7a33e546a55845051b3b81cde0e045d4508908b27a49aaa0ed55c43c8d4ef28c54b641660d457d4e0956cc1c63a77a98f39dd5f1f185b98ca08ddcf649ac1ca8df725e021298352a5daf44f9a1caedecd9fef2bd509ae43c0ea00223058d54f8445d1e53e2586600db633ed9aba3f81fa9977fabde53fca4b4d7a0c39638566db5d144df1521afe1e7451ec1836ead2eda423443b66ec0e113de30a011a3c497474d46e16a1f15c3558d5043a994a7df3e4f7e68025f344e12e7de85a0814c5111d3853dcfb4b3008e983364d68869897ef3d246e482f5d51c97dbef10a04d1605e0a23e25bb985b83a0f9743e632c737336cdf7394c1a9a4dfee19a9168a031e6c9c8329cbe268f83da4e8eca50a20a95c28f15780d332625f51122bdd797a05c1fb1a5be55ecc86189fd3a9ea070ec9e4b9394618c9cba8ef47eb77488dc02a0220348f330a91580351ba1be5c36264497e75f6fc1ddf109c80e0069819347f2a0809145f936a7b913fc86edc2dd914b5c835b2b17a4fb2cafda62ca6d2440df3680","0xf90211a0bcef09832cca3e0d23f7ea55f6e605bd36141a362094e57a698fe5a086ab3f2ea067f569bf8e06758f39fc95fb312f808cad88dc7a62cc82937ea7214d43216fcaa02832f266942fa9a3f6b55d05f8e6f1408f6d82356a761578c7dae9408b7f0d50a0c75bd37f1e94fc6c322e3e5b50b3e36efaa626b457df7ecacb3b8e65fad53bbaa03e4ff0b64aa60e9ea8329cadb49ba89f7cad0c541d525956b7484133aa973979a0d32e95abde9c3278cf4e7a16d4edcde194410ae0ce8df4ff78c5441236d53837a07703f8673c8d74beb4e639d0a4603b9026e20fea0c6547eda433df2d9b53dc56a0fac583c68287d294eb76815bb4841b992187add002f0e563b891e71d157af33aa096c85eaa274319ced0ead3cd0054563b59a2fbf750542e5029b83a5a5ded67e2a00cf31256126ad966492d04f22dbbc70880a5dbfcf3d795842b1a1fc36684e419a0359a1ab3ca5de3682cb57bbf0d5c9959f6c964e0f7c0e99580de14108fae6d9ca03e165d0a6c4d7e02bf4f459188eb5a0ec51ee3f960eaec1a8d9efa4a25e2fd25a031444ce52cb0b9d698f314acbbea8b98ca6df2a789ba35f1af64b07989659ca7a0b6e6da13a8361f323f7391facc8a20c5af184c8e345ab2396c94c868f420653ca0259dbbb9fed067946c475cfe4919ca6ac8f089fc61aa7fbd76f3b9b8f6271617a05b2f4edce7b144f1f00fc61539ac43b772684dc1953ad3a885630cb351fc257680","0xf90211a002e5af012079123236fdb908236ea6aebaddff546e2580424101a23211fbde75a003fd741237eb90196f5822f91888074b2180d250a8ff48b41563cd94a817becca06233754ce9b2df7e1ad659e5515b042fe9007f76274f38df178ade77f5b74440a007f4b142b3b9599e91052f14872506bb1bee0b7ee70dc242d19268a0d0eeaa12a0a0b5f6499ae2ef83a1be1e3d73e4b88b3d322911457e97abb42a23758bb351d3a08e35b9b0f4ad1b5a6fbddcdacaa2463d3d4d7c8dd406ce19cd206c6595db674ba02bf200d3016a9e9eee1976618999c27abdbd63b3c5e675d64a833b1685944352a024e0583914d4ab6c6cbb5aac193b479d48ab3254ab3e88e5b6544a882dcf8933a09d7b11fa377dbf3d92f06faea40962189f388e87fad8cf0ece2196b8b30e9da4a01667268a20948d7525d576628d2ba3707a94d3b1da0ba7f28a45bba4737d2894a08c0b6a7b94d696bf5c532c613e0feb3dba82c55c4fb01134c83c319402d2b871a0026671a3a43a954d025e47e750244cf4b04a8354fde6cbea9c467368049c1feea0507b816282aefd8f3b582bd6ae7d5acb037b313debc2028e57b9cae229e1db9ca09ce3d88f7e1f321e187d1b234c2493e81b5d7b47ad6f0cb0bfd1c9ac5e5f74a6a092c2f1e2ce6ea1015f77d98c0072e7ec9b1e18406b0ba41cff9c1cdae71c9542a0b34ec209c27899ca2b1ea2d07361ea00628d28e53414dd6bfa39c39cb7eaf23e80","0xf90191a07fe5ff2aa391a7ea09ac6d55f4621aaf23cb322e559c110f3bc3c7eb3eda7a8ca0230e6812eb0e8bba2ad95edc695412e33e85539d0eab1e96968bab9f9f1f019c80a0d28dd1d2320e9e15e8bef5636e8d3e2c9b32d9c1475c78e4a435bcd3e19b812aa07a33a6998479f52a1d7c06d675a6e876c68727a61caa34e39115f03efb3afc1280a0dd4290c3837afd01faa42f458e0486bbfc4885b57b5c835f0ee6fcf55b21a394a00f07b81acd0335f3263af89f877e72bd60a5b2b5bb3e0d6d8cbf5f5f5f85ce16a0e338a2c0be8577567cb62a6d58a95d8f59a5ff1b2711f75bb31ccc094bf7aaafa0d5b82a1d9af21fee4199b9867316f027f9af7d3773e1710ce7d200a93c67fef8a023963250bd9f8e7a05e57c71bbeeb1c2543777aad8175579d4a285eb966e2cf580a0619d3a8d0f12f692c9cb482d18f6d89b9f4dc4387f1a5c3d5695a58e169c6aeaa026047caa832100fdac0ade771d2559e4b250c1ebd4d3f2c58ce3ffb8a73a3a54a0aa24cea6d585f51e7363e9188e0ceca15a2fcf8ef7b06ffb8a244e38444893ab8080","0xf8679e20a156fa491379eaedeba66e5a505622acecbf4ba5671e47f00370827178b846f8440180a0ac92f34547c3928bff4b16a01d011cdd313f5c8658a0ebbc419d731fc96aed01a0d5415eb1d2e74e08407476508707137c7e35dbf42995dd07e273c83b4c384c9d"],"storageProof":[{"key":"0x50a82f9cbcdfaca82fe46b4a494d325ee6dc33d1fa55b218ab142e6cc2c8a58b","value":"0x2d37cc264865ae01b30172c43ac9ace29ba1dee20f10aa74ce291b26689c050b","proof":["0xf90211a0b07d4dbb8e1e7f7357496c011b008c5a49531e90725e1957d769dc720fcbd8d7a0172557790331f25ff2b5aada1d25bddf0fda4ea790a40ef0e596a45fe173b1e6a0e312e10d94bd7dad39723078aba881d4235043bc3c1ab59f44cea61c0e56a1b7a04d0c28f3e08dd98e7ea6597fbe6c604592c7f2359db9bc42bf3e4b8bf42459c5a0f1562a82dbc1994119ea29a65f255eda43959309171b4606f4011cafd0173ac2a01fc25384137fa860cb740f1811cea39bd6a5c86f52d45ad6d3a00b40f60d444aa089f45efd567de9edc6a8bfa4bc8684dc4118833a51a5f20d6d7c0e719586a909a06b6d587b1aa7fc7d81a56bc9cd20d621a1772c814cccc873692572bca93106d4a03d51ba86ef58614506f4c4425eda5692e71a818171a669dcaee5ea10f3902e38a09566b3631d046edda78a244db59304ccd8cea8287d23dcd0d03a77fcd60a0c1aa097c7251c12165854304785062c881394e9eeacc9bb55dd08a9331730bcae2711a0f677cebfff0adfd030227685d7c231fc9c8ecedb8b0fa62250948ff6f895efa9a0106b34679f06a804b941370b81bb6d68e79505a387a49dcd236a0a88063aa527a0579f36e4d3ae280c83851cb791e4ee75d80d832762e95275a15c1ae33657d9ffa0b7ca9f6e6fd1d25fbd44ced8561c290c3cabbf2891b4b8289ca54d671e887430a05177446b71571d22b976133f873355c383667a2d60e1ca3ebd882854a7aac8f580","0xf90191a0525d0baab303e971a33085929b03ad88fe97a9c2ab92480a4d09720599581c11a0e783b08ecb0ae24cbcb1804bc4f422557bce71f077adf4edf7c275a745ed5b2a8080a0c310a228b83f5310ca38b83415b7113ce621743b74fbbeb907944115859dbb4ca0085b66671b0eb402d360bfe181b2cb883720167bd782bf4bbdf920998a001414a05ee03832f17957b631b15db06fa7bdf3b8f0cd1c61d27af684ca60bd15e041bca0a4dae0acbd7fe8b71b48f520fef3c35b946cdce186b76e675595ddbbedb59363a0f81d3a61a2a23dc07866ea1ccaafb4368da835809cc7159ce8703ac8ead6cdcca046d79da3f2ac115f3da3e0cb95a77e778da969b02aa20a8841907a3fd4e1076f80a0e1d17b106cd31499d9700b73d5f8b5c5bdc02835ccc0486dc9d4d0b834de8a1980a0d860e04becc55860efa5f851d389d43d40177caa56f6244e0213ff58ecfdf53aa0dbb6dfc13a9106cf6aed1840f26a4a41ed9ad97b7f87e09cc1eb10beaee87092a0e974b76e9fd2af46966cbdf4aad7fb986b68ce470a660f6ac37d393149b99dbb80","0xf843a02038fd5b02a17455a63e08ef8acf42f0c690bb3323f43c6cfc048729c3a46670a1a02d37cc264865ae01b30172c43ac9ace29ba1dee20f10aa74ce291b26689c050b"]}]}`)
		value, _ := hex.DecodeString("20000000000000000000000000000000000000000000000000000000000000001320000000000000000000000000000000000000000000000000000000000000001314662e1b7ba042f389cb1b26c4d988e137d540fc4301000000000000000362746306756e6c6f636bfd1d01226d6a456f79794350734c7a4a3233784d58364d746931337a4d794e33366b7a6e353740420f0000000000f15521023ac710e73e1410718530b2686ce47f12fa3c470a9eb6085976b70b01c64c9f732102c9dc4d8f419e325bbef0fe039ed6feaf2079a2ef7b27336ddb79be2ea6e334bf2102eac939f2f0873894d8bf0ef2f8bbdd32e4290cbf9632b59dee743529c0af9e802103378b4a3854c88cca8bfed2558e9875a144521df4a75ab37a206049ccef12be692103495a81957ce65e3359c114e6c2fe9f97568be491e3f24d6fa66cc542e360cd662102d43e29299971e802160a92cfcd4037e8ae83fb8f6af138684bebdc5686f3b9db21031e415c04cbc9b81fbee6e04d8c902e8f61109a2c9883a959ba528c52698c055a57ae")
		param.SourceChainID = 2
		param.Height = 7259464
		param.Proof = proof
		param.RelayerAddress = acct.Address[:]
		param.Extra = value
		param.HeaderOrCrossChainMsg = []byte{}
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), native.GetCacheDB())
		_, err := ethTxHandler.MakeDepositProposal(native)
		assert.Equal(t, PROOF_FORMAT_ERROR, typeOfError(err))
	}
}

func TestProofHandle_VerifyProofWrong(t *testing.T) {
	ethSyncHandler := synceth.NewETHHandler()
	ethTxHandler := NewETHHandler()
	var native *native.NativeService
	{
		header7259461, _ := hex.DecodeString("7b22706172656e7448617368223a22307862323534646537333339313834366561343439393066656233336464633266333236303337653232663130646165353939633533646537626363623565616636222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307832373764316465343036313662626363356232653535333238363063646231613332376565343263356135363934363865333835363738316563363663636333222c227472616e73616374696f6e73526f6f74223a22307835303735383837336631313030313861656363366533656564326664386163633761393162343134316338623263373866306665643536636464306532343231222c227265636569707473526f6f74223a22307861613331363939373365666263633233323330376663613266386363393965653833316533623665333431613134393135633130363739303136656665313462222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030222c22646966666963756c7479223a2230783331616235653166222c226e756d626572223a223078366563353435222c226761734c696d6974223a223078376131323164222c2267617355736564223a22307837623365222c2274696d657374616d70223a2230783565333932386133222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307864333663656666636631303036643334626533316337343764613235316335336663393165333633623563323762323631613364353434343530396230613135222c226e6f6e6365223a22307838353561613936393133323963323764222c2268617368223a22307836353834356566633832366366326238363863346462663232363633396534616364346161643933656263636462653162373035663432663035393363333364227d")
		param := new(synccom.SyncGenesisHeaderParam)
		param.ChainID = 2
		param.GenesisHeader = header7259461
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), nil)
		err := ethSyncHandler.SyncGenesisHeader(native)
		assert.Equal(t, SUCCESS, typeOfError(err))
		height := getLatestHeight(native)
		assert.Equal(t, uint64(7259461), height)
	}
	{
		header7259462, _ := hex.DecodeString("7b22706172656e7448617368223a22307836353834356566633832366366326238363863346462663232363633396534616364346161643933656263636462653162373035663432663035393363333364222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307831623138326132383831363564626662626361633661613137333361336130633866393062663538623133626332616666333533323432396164366637613838222c227472616e73616374696f6e73526f6f74223a22307865616336616533356562306639396336613133306264346465333661626534376464613932336266653365653833386236666135333865303534313730623962222c227265636569707473526f6f74223a22307831396561393430653166653936373239303930373565383066623332363665343235653434396662306662313061666166303737363564386261353261336366222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303031303030303030303030303030303030303030303030303030303030303030303030303230303030303030303030303030303031303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303034303030343030303030303030303030303030323030303030303430303030303030303030303030303030303030303030303030323030303030303030303030323030303030303030303030303031303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303130303030222c22646966666963756c7479223a2230783331623139333861222c226e756d626572223a223078366563353436222c226761734c696d6974223a223078376131323164222c2267617355736564223a2230783765373565222c2274696d657374616d70223a2230783565333932386135222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307835373133363435343765636632343630356565386130326438376366646462653736386662353936396639356235646132643333623339356137316632656532222c226e6f6e6365223a22307832623761663433336261613737306636222c2268617368223a22307839326231646136643062313039623239343534653632653431616231613235353863666339663661363533333861666333613662333166656161636363313533227d")
		header7259463, _ := hex.DecodeString("7b22706172656e7448617368223a22307839326231646136643062313039623239343534653632653431616231613235353863666339663661363533333861666333613662333166656161636363313533222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307830663538353965653239346462393134373662623731376338616661313233373235663665633536353737633237656266386434366533323166326561336437222c227472616e73616374696f6e73526f6f74223a22307862306537653339323434613863313736356638633361653565303962363766353464373962393339653335386333613961653864633532316633643164646537222c227265636569707473526f6f74223a22307866316361393239393938643738613035333131616639383137393166633338383135656263643036376563383965623735343733616566316338396130663264222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303830303030303032303030303030303030303030313030303030303030313030303030323030303030303030303030303030343030303030303030383030303030303030303030343030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303034303030303030303030303130303038303030303130303030303030303030343030303030303030303030303030303030303030303030303030303030303030303230303030303030303030303030303030303030383030303030303030303030303030303030313030303030303130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030343030303030303031303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030323030303030303030303030303030303030303032303032303030303030303030303030303030303030303030303830303030303030303030303030303030303030303030303030303030303230303030303030303030303030303030303030303030303030323230303030303030303030303030303030303030303030303030303430303030303430303030303430222c22646966666963756c7479223a2230783331616235643538222c226e756d626572223a223078366563353437222c226761734c696d6974223a223078376131323164222c2267617355736564223a223078373966653031222c2274696d657374616d70223a2230783565333932386263222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307838623638653937613336616437336566383437336365343636643932633634313339396532336364393032366561336539656465613835343035336131343765222c226e6f6e6365223a22307838353561613936393239326336653362222c2268617368223a22307832326437336361356662626230633864376434333339623133613432343339663133343963633735633563616134633935623666336463613235343435633730227d")
		header7259464, _ := hex.DecodeString("7b22706172656e7448617368223a22307832326437336361356662626230633864376434333339623133613432343339663133343963633735633563616134633935623666336463613235343435633730222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307836633836653661613830303566663433356264656639393736653433396434616339333866616466346231656537663031376563333664313661346131623266222c227472616e73616374696f6e73526f6f74223a22307864316635353761623865663631396461313664633266366338363165613034373737616664623766646666373763363964343462653130373165306362656332222c227265636569707473526f6f74223a22307864623563643163643264336533343936653533343762666532643764326561653534356264303466393863373330343364323165386664373065656536633837222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030343030383030303030303430303030343030303030303030303030303030303030303030303831303030303030303030303031303030303031303030323030306130303031303034303032313030303030303039303030303030303030303830313030303831323030303438303030303230303030303030323030303030633030303038303034303430303038303030303030303030323030303030303030303030303030303030303030343031303030303434303432303030303030303030303830303130303030303030303030303030303834303434303030303030303030303130303030303032303030303030323030303032303530303030343031323030303030313030303030383030313030303032303030303030303030303030303030303030303030303430303230303030303030323030303034303030303030303030313030303036303030303030303030303230303030303030303030303030303030303030303030303038303030363032303030303030303030303030303032306430303430303030303030303030343030303030303030303030303030303030303030303030323030303330303230323030303230303230303030303038303030613030303030303030303030303230323032303030303134303530303030303030313134303030222c22646966666963756c7479223a2230783331396566323832222c226e756d626572223a223078366563353438222c226761734c696d6974223a223078376131323164222c2267617355736564223a223078326562663137222c2274696d657374616d70223a2230783565333932386463222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307866643433393339333563666130343861653762653761616136313162623036383638303935326335393262383831313333333366643733323236393637616232222c226e6f6e6365223a22307838353561613936393133333264363966222c2268617368223a22307836336162343534613932666466356634363865356462393031306234633663626334636664393661386332316430353333623638386636633837313334643334227d")
		header7259465, _ := hex.DecodeString("7b22706172656e7448617368223a22307836336162343534613932666466356634363865356462393031306234633663626334636664393661386332316430353333623638386636633837313334643334222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307864663265313332303766336161623238396662393662343963363430326462303362376664396435396266663761353632363164326161393331376462666464222c227472616e73616374696f6e73526f6f74223a22307838383338303065333166303934633664356136663832613631663835316237323232353631303930306139653739626165386534323839313464636334353263222c227265636569707473526f6f74223a22307830353662323366626261343830363936623635666535613539623866323134386131323939313033633466353764663833393233336166326366346361326432222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030222c22646966666963756c7479223a2230783331613532363630222c226e756d626572223a223078366563353439222c226761734c696d6974223a223078376131323164222c2267617355736564223a22307835323038222c2274696d657374616d70223a2230783565333932386465222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307835316430396562623331616664353963626432386663373437393237313437373839343966306230353039303164306235376335396661366130343333343564222c226e6f6e6365223a22307838353561613936393137623336396230222c2268617368223a22307861656632393933313662656362663339353738616565633438333265393332303830393732313065346661646331356230383031376466363966333134346462227d")

		param := new(synccom.SyncBlockHeaderParam)
		param.ChainID = 2
		param.Address = acct.Address
		param.Headers = append(param.Headers, header7259462)
		param.Headers = append(param.Headers, header7259463)
		param.Headers = append(param.Headers, header7259464)
		param.Headers = append(param.Headers, header7259465)
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), native.GetCacheDB())
		err := ethSyncHandler.SyncBlockHeader(native)
		assert.Equal(t, SUCCESS, typeOfError(err))
		height := getLatestHeight(native)
		assert.Equal(t, uint64(7259465), height)
	}
	{
		param := new(ccmcom.EntranceParam)
		proof := []byte(`{"address":"0x4b61a4c0ab51b53cfabf1339bfdb7dfd27be596a","balance":"0x0","codeHash":"0xd5415eb1d2e74e08407476508707137c7e35dbf42995dd07e273c83b4c384c9d","nonce":"0x1","storageHash":"0xac92f34547c3928bff4b16a01d011cdd313f5c8658a0ebbc419d731fc96aed01","accountProof":["0xf90211a044cdba96ea41a639286789665321c82b82da3af44c13a23e89cd7d12489f275ba04f667ad4dd8b93125a461fa90cba9824de0cc6e463963f70546d34eb5d0850ada090b90837f8e344dffde14735d66fb53204b77d546b2d588013f669a6d7cbb052a03fdca5da44fdfa953009a1a393c92af32d4aba170d9d4a355c72d74ff3609ee0a0fb715e667b8ea2a486fa7664b6319f9ad70c8a02a8523ea66018c8a800796312a0e1b0607233b4eb726ec99b875021cd7a419dfa7db281509b09d5e0e586bf20e5a0e0f020646f30505c6dee185e2b15b69b41229f4a5ef3bd1b86a7640323267d0da04a9248c1e2376c795d7e7092f5f269112a5ef0ba9f615691752d327a2e14db46a09434b2e9ce4f7902049c73069aa4e06a64e1b4f66ad28886c1d2dbce4f8d8885a049723843c76c139ee6a852913a15f867bf6996efeab24093831448a3fd319060a0c76af527df045ec8841d3844f75c0df45413eb39e4d133bca4ef6b9f34c14e9ba0e1d251bed147df5615e73e38b5116b9613edfbd40148698ba37d8aaa4c96d08ea0f71d80eb8db1138d42e8ba10e4bbf752e63ba3a2e6202cf77bd139b1f2037909a0cd5faa98e3fb40080b58bafb07477761d5259293313bba9dfa2a717263cc2c6aa0a7da5f100c1ad5e1adc36cbe42b2a75b8e98e7f6ed834f17d2d986220c68dd0ea070e309eb14f7938217f161f05a3322e4334fd71216e2cc39f5581a4968f39c9a80","0xf90211a0bc3c4c601894a3e2e1f63e6a0cb8ded9a45f9d490a48d2e468fa1ef0f811c46aa0ba2c588cfaa0f80fbf358c3122d87c450e0c3c4f4f11ee666f8d373542915ff3a0df808f83f713ba243c4d1f8524de68c1321a2997fe8e90707199fe273eff9e80a0b271d852ef674361d567538ac385fcc3a64393b83e74ca5042a80561ea930f41a09e394e781d7456fec9c3eee07958624ded9f3dd33a7417e911d829f1b8a3fc2da038836c839d052cfac47eadc38eef898e81a141b861aae160b458dc2a810377fca08e0f1718e800fff19325f89e794371576d317ef69a42bc58a7d06bb22bcea109a0248d5e1d35531a8ae584f4748ba9f066b2db80b66988735c4a42ebe9fe840e32a0f85898019742452e3e6f13ab0eba8be413f703f9b6ddb738a8ffee3a5b6921cfa0d8911f2a5d448d870e75995b5d424040f639ba07a018813c6c3f4534b2a40588a0940046d1f708d0a435ae58a899dca8f0cc2b10ba37bfd5a8e1ea31d2a6e7f370a09cc6a3faaf4dbb3ec1c6a545f69ee5ea4be632edfd7da38005466de113f4fe1ea071a50ff6f949b9b7b39754857b10f8e988f378e740c917fbc47d07363f348eb0a0b1df183e8603fb1c3aad3af711d2e15696f256f5dd2c94bd88be390f13013762a018f2794476d5b40a054196c7f2aa218c508cd4f10a85f71222a7c08ab5cbd109a0f296cfcd6b516e9c8d2c1a90c5ddd8393667baf9b7fc37f7b403f3a26d36e1c080","0xf90211a0616b9d83bd7f96de1864f0fe3e16badf4dfa89b8f3eba721a46c7f232d930e5ba09e71d9854994874d673e049153c7accf44196a6211b80ef97b3d29e636db521aa048d549ac792bbf2e3f07a7362b81f8817193c446c56eb66b71abe7ca6fe5c6a5a0e120d0b4dadef4604bd8b9250ad6ca3ca6b11da171e209a566924950af03571ba067f4f8626b8af02a4b7a33e546a55845051b3b81cde0e045d4508908b27a49aaa0ed55c43c8d4ef28c54b641660d457d4e0956cc1c63a77a98f39dd5f1f185b98ca08ddcf649ac1ca8df725e021298352a5daf44f9a1caedecd9fef2bd509ae43c0ea00223058d54f8445d1e53e2586600db633ed9aba3f81fa9977fabde53fca4b4d7a0c39638566db5d144df1521afe1e7451ec1836ead2eda423443b66ec0e113de30a011a3c497474d46e16a1f15c3558d5043a994a7df3e4f7e68025f344e12e7de85a0814c5111d3853dcfb4b3008e983364d68869897ef3d246e482f5d51c97dbef10a04d1605e0a23e25bb985b83a0f9743e632c737336cdf7394c1a9a4dfee19a9168a031e6c9c8329cbe268f83da4e8eca50a20a95c28f15780d332625f51122bdd797a05c1fb1a5be55ecc86189fd3a9ea070ec9e4b9394618c9cba8ef47eb77488dc02a0220348f330a91580351ba1be5c36264497e75f6fc1ddf109c80e0069819347f2a0809145f936a7b913fc86edc2dd914b5c835b2b17a4fb2cafda62ca6d2440df3680","0xf90211a0bcef09832cca3e0d23f7ea55f6e605bd36141a362094e57a698fe5a086ab3f2ea067f569bf8e06758f39fc95fb312f808cad88dc7a62cc82937ea7214d43216fcaa02832f266942fa9a3f6b55d05f8e6f1408f6d82356a761578c7dae9408b7f0d50a0c75bd37f1e94fc6c322e3e5b50b3e36efaa626b457df7ecacb3b8e65fad53bbaa03e4ff0b64aa60e9ea8329cadb49ba89f7cad0c541d525956b7484133aa973979a0d32e95abde9c3278cf4e7a16d4edcde194410ae0ce8df4ff78c5441236d53837a07703f8673c8d74beb4e639d0a4603b9026e20fea0c6547eda433df2d9b53dc56a0fac583c68287d294eb76815bb4841b992187add002f0e563b891e71d157af33aa096c85eaa274319ced0ead3cd0054563b59a2fbf750542e5029b83a5a5ded67e2a00cf31256126ad966492d04f22dbbc70880a5dbfcf3d795842b1a1fc36684e419a0359a1ab3ca5de3682cb57bbf0d5c9959f6c964e0f7c0e99580de14108fae6d9ca03e165d0a6c4d7e02bf4f459188eb5a0ec51ee3f960eaec1a8d9efa4a25e2fd25a031444ce52cb0b9d698f314acbbea8b98ca6df2a789ba35f1af64b07989659ca7a0b6e6da13a8361f323f7391facc8a20c5af184c8e345ab2396c94c868f420653ca0259dbbb9fed067946c475cfe4919ca6ac8f089fc61aa7fbd76f3b9b8f6271617a05b2f4edce7b144f1f00fc61539ac43b772684dc1953ad3a885630cb351fc257680","0xf90211a002e5af012079123236fdb908236ea6aebaddff546e2580424101a23211fbde75a003fd741237eb90196f5822f91888074b2180d250a8ff48b41563cd94a817becca06233754ce9b2df7e1ad659e5515b042fe9007f76274f38df178ade77f5b74440a007f4b142b3b9599e91052f14872506bb1bee0b7ee70dc242d19268a0d0eeaa12a0a0b5f6499ae2ef83a1be1e3d73e4b88b3d322911457e97abb42a23758bb351d3a08e35b9b0f4ad1b5a6fbddcdacaa2463d3d4d7c8dd406ce19cd206c6595db674ba02bf200d3016a9e9eee1976618999c27abdbd63b3c5e675d64a833b1685944352a024e0583914d4ab6c6cbb5aac193b479d48ab3254ab3e88e5b6544a882dcf8933a09d7b11fa377dbf3d92f06faea40962189f388e87fad8cf0ece2196b8b30e9da4a01667268a20948d7525d576628d2ba3707a94d3b1da0ba7f28a45bba4737d2894a08c0b6a7b94d696bf5c532c613e0feb3dba82c55c4fb01134c83c319402d2b871a0026671a3a43a954d025e47e750244cf4b04a8354fde6cbea9c467368049c1feea0507b816282aefd8f3b582bd6ae7d5acb037b313debc2028e57b9cae229e1db9ca09ce3d88f7e1f321e187d1b234c2493e81b5d7b47ad6f0cb0bfd1c9ac5e5f74a6a092c2f1e2ce6ea1015f77d98c0072e7ec9b1e18406b0ba41cff9c1cdae71c9542a0b34ec209c27899ca2b1ea2d07361ea00628d28e53414dd6bfa39c39cb7eaf23e80","0xf90191a07fe5ff2aa391a7ea09ac6d55f4621aaf23cb322e559c110f3bc3c7eb3eda7a8ca0230e6812eb0e8bba2ad95edc695412e33e85539d0eab1e96968bab9f9f1f019c80a0d28dd1d2320e9e15e8bef5636e8d3e2c9b32d9c1475c78e4a435bcd3e19b812aa07a33a6998479f52a1d7c06d675a6e876c68727a61caa34e39115f03efb3afc1280a0dd4290c3837afd01faa42f458e0486bbfc4885b57b5c835f0ee6fcf55b21a394a00f07b81acd0335f3263af89f877e72bd60a5b2b5bb3e0d6d8cbf5f5f5f85ce16a0e338a2c0be8577567cb62a6d58a95d8f59a5ff1b2711f75bb31ccc094bf7aaafa0d5b82a1d9af21fee4199b9867316f027f9af7d3773e1710ce7d200a93c67fef8a023963250bd9f8e7a05e57c71bbeeb1c2543777aad8175579d4a285eb966e2cf580a0619d3a8d0f12f692c9cb482d18f6d89b9f4dc4387f1a5c3d5695a58e169c6aeaa026047caa832100fdac0ade771d2559e4b250c1ebd4d3f2c58ce3ffb8a73a3a54a0aa24cea6d585f51e7363e9188e0ceca15a2fcf8ef7b06ffb8a244e38444893ab8080","0xf8679e20a156fa491379eaedeba66e5a505622acecbf4ba5671e47f00370827178b846f8440180a0ac92f34547c3928bff4b16a01d011cdd313f5c8658a0ebbc419d731fc96aed01a0d5415eb1d2e74e08407476508707137c7e35dbf42995dd07e273c83b4c384c9d"],"storageProof":[{"key":"0x50a82f9cbcdfaca82fe46b4a494d325ee6dc33d1fa55b218ab142e6cc2c8a58b","value":"0x2d37cc264865ae01b30172c43ac9ace29ba1dee20f10aa74ce291b26689c050b","proof":["0xf90211a0b07d4dbb8e1e7f7357496c011b008c5a49531e90725e1957d769dc720fcbd8d7a0172557790331f25ff2b5aada1d25bddf0fda4ea790a40ef0e596a45fe173b1e6a0e312e10d94bd7dad39723078aba881d4235043bc3c1ab59f44cea61c0e56a1b7a04d0c28f3e08dd98e7ea6597fbe6c604592c7f2359db9bc42bf3e4b8bf42459c5a0f1562a82dbc1994119ea29a65f255eda43959309171b4606f4011cafd0173ac2a01fc25384137fa860cb740f1811cea39bd6a5c86f52d45ad6d3a00b40f60d444aa089f45efd567de9edc6a8bfa4bc8684dc4118833a51a5f20d6d7c0e719586a909a06b6d587b1aa7fc7d81a56bc9cd20d621a1772c814cccc873692572bca93106d4a03d51ba86ef58614506f4c4425eda5692e71a818171a669dcaee5ea10f3902e38a09566b3631d046edda78a244db59304ccd8cea8287d23dcd0d03a77fcd60a0c1aa097c7251c12165854304785062c881394e9eeacc9bb55dd08a9331730bcae2711a0f677cebfff0adfd030227685d7c231fc9c8ecedb8b0fa62250948ff6f895efa9a0106b34679f06a804b941370b81bb6d68e79505a387a49dcd236a0a88063aa527a0579f36e4d3ae280c83851cb791e4ee75d80d832762e95275a15c1ae33657d9ffa0b7ca9f6e6fd1d25fbd44ced8561c290c3cabbf2891b4b8289ca54d671e887430a05177446b71571d22b976133f873355c383667a2d60e1ca3ebd882854a7aac8f580","0xf90191a0525d0baab303e971a33085929b03ad88fe97a9c2ab92480a4d09720599581c11a0e783b08ecb0ae24cbcb1804bc4f422557bce71f077adf4edf7c275a745ed5b2a8080a0c310a228b83f5310ca38b83415b7113ce621743b74fbbeb907944115859dbb4ca0085b66671b0eb402d360bfe181b2cb883720167bd782bf4bbdf920998a001414a05ee03832f17957b631b15db06fa7bdf3b8f0cd1c61d27af684ca60bd15e041bca0a4dae0acbd7fe8b71b48f520fef3c35b946cdce186b76e675595ddbbedb59363a0f81d3a61a2a23dc07866ea1ccaafb4368da835809cc7159ce8703ac8ead6cdcca046d79da3f2ac115f3da3e0cb95a77e778da969b02aa20a8841907a3fd4e1076f80a0e1d17b106cd31499d9700b73d5f8b5c5bdc02835ccc0486dc9d4d0b834de8a1980a0d860e04becc55860efa5f851d389d43d40177caa56f6244e0213ff58ecfdf53aa0dbb6dfc13a9106cf6aed1840f26a4a41ed9ad97b7f87e09cc1eb10beaee87092a0e974b76e9fd2af46966cbdf4aad7fb986b68ce470a660f6ac37d393149b99dbb80","0xf843a02038fd5b02a17455a63e08ef8acf42f0c690bb3323f43c6cfc048729c3a46670a1a02d37cc264865ae01b30172c43ac9ace29ba1dee20f10aa74ce291b26689c050b"]}]}`)
		value, _ := hex.DecodeString("200000000000000000000000000000000000000000000000000000000000001320000000000000000000000000000000000000000000000000000000000000001314662e1b7ba042f389cb1b26c4d988e137d540fc4301000000000000000362746306756e6c6f636bfd1d01226d6a456f79794350734c7a4a3233784d58364d746931337a4d794e33366b7a6e353740420f0000000000f15521023ac710e73e1410718530b2686ce47f12fa3c470a9eb6085976b70b01c64c9f732102c9dc4d8f419e325bbef0fe039ed6feaf2079a2ef7b27336ddb79be2ea6e334bf2102eac939f2f0873894d8bf0ef2f8bbdd32e4290cbf9632b59dee743529c0af9e802103378b4a3854c88cca8bfed2558e9875a144521df4a75ab37a206049ccef12be692103495a81957ce65e3359c114e6c2fe9f97568be491e3f24d6fa66cc542e360cd662102d43e29299971e802160a92cfcd4037e8ae83fb8f6af138684bebdc5686f3b9db21031e415c04cbc9b81fbee6e04d8c902e8f61109a2c9883a959ba528c52698c055a57ae")
		param.SourceChainID = 2
		param.Height = 7259464
		param.Proof = proof
		param.RelayerAddress = acct.Address[:]
		param.Extra = value
		param.HeaderOrCrossChainMsg = []byte{}
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), native.GetCacheDB())
		_, err := ethTxHandler.MakeDepositProposal(native)
		assert.Equal(t, VERIFY_PROOT_ERROR, typeOfError(err))
	}
}

func TestProofHandle_CommitTwice(t *testing.T) {
	ethSyncHandler := synceth.NewETHHandler()
	ethTxHandler := NewETHHandler()
	var native *native.NativeService
	{
		header7259461, _ := hex.DecodeString("7b22706172656e7448617368223a22307862323534646537333339313834366561343439393066656233336464633266333236303337653232663130646165353939633533646537626363623565616636222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307832373764316465343036313662626363356232653535333238363063646231613332376565343263356135363934363865333835363738316563363663636333222c227472616e73616374696f6e73526f6f74223a22307835303735383837336631313030313861656363366533656564326664386163633761393162343134316338623263373866306665643536636464306532343231222c227265636569707473526f6f74223a22307861613331363939373365666263633233323330376663613266386363393965653833316533623665333431613134393135633130363739303136656665313462222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030222c22646966666963756c7479223a2230783331616235653166222c226e756d626572223a223078366563353435222c226761734c696d6974223a223078376131323164222c2267617355736564223a22307837623365222c2274696d657374616d70223a2230783565333932386133222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307864333663656666636631303036643334626533316337343764613235316335336663393165333633623563323762323631613364353434343530396230613135222c226e6f6e6365223a22307838353561613936393133323963323764222c2268617368223a22307836353834356566633832366366326238363863346462663232363633396534616364346161643933656263636462653162373035663432663035393363333364227d")
		param := new(synccom.SyncGenesisHeaderParam)
		param.ChainID = 2
		param.GenesisHeader = header7259461
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), nil)
		err := ethSyncHandler.SyncGenesisHeader(native)
		assert.Equal(t, SUCCESS, typeOfError(err))
		height := getLatestHeight(native)
		assert.Equal(t, uint64(7259461), height)
	}
	{
		header7259462, _ := hex.DecodeString("7b22706172656e7448617368223a22307836353834356566633832366366326238363863346462663232363633396534616364346161643933656263636462653162373035663432663035393363333364222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307831623138326132383831363564626662626361633661613137333361336130633866393062663538623133626332616666333533323432396164366637613838222c227472616e73616374696f6e73526f6f74223a22307865616336616533356562306639396336613133306264346465333661626534376464613932336266653365653833386236666135333865303534313730623962222c227265636569707473526f6f74223a22307831396561393430653166653936373239303930373565383066623332363665343235653434396662306662313061666166303737363564386261353261336366222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303031303030303030303030303030303030303030303030303030303030303030303030303230303030303030303030303030303031303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303034303030343030303030303030303030303030323030303030303430303030303030303030303030303030303030303030303030323030303030303030303030323030303030303030303030303031303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303130303030222c22646966666963756c7479223a2230783331623139333861222c226e756d626572223a223078366563353436222c226761734c696d6974223a223078376131323164222c2267617355736564223a2230783765373565222c2274696d657374616d70223a2230783565333932386135222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307835373133363435343765636632343630356565386130326438376366646462653736386662353936396639356235646132643333623339356137316632656532222c226e6f6e6365223a22307832623761663433336261613737306636222c2268617368223a22307839326231646136643062313039623239343534653632653431616231613235353863666339663661363533333861666333613662333166656161636363313533227d")
		header7259463, _ := hex.DecodeString("7b22706172656e7448617368223a22307839326231646136643062313039623239343534653632653431616231613235353863666339663661363533333861666333613662333166656161636363313533222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307830663538353965653239346462393134373662623731376338616661313233373235663665633536353737633237656266386434366533323166326561336437222c227472616e73616374696f6e73526f6f74223a22307862306537653339323434613863313736356638633361653565303962363766353464373962393339653335386333613961653864633532316633643164646537222c227265636569707473526f6f74223a22307866316361393239393938643738613035333131616639383137393166633338383135656263643036376563383965623735343733616566316338396130663264222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303830303030303032303030303030303030303030313030303030303030313030303030323030303030303030303030303030343030303030303030383030303030303030303030343030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303034303030303030303030303130303038303030303130303030303030303030343030303030303030303030303030303030303030303030303030303030303030303230303030303030303030303030303030303030383030303030303030303030303030303030313030303030303130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030343030303030303031303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030323030303030303030323030303030303030303030303030303030303032303032303030303030303030303030303030303030303030303830303030303030303030303030303030303030303030303030303030303230303030303030303030303030303030303030303030303030323230303030303030303030303030303030303030303030303030303430303030303430303030303430222c22646966666963756c7479223a2230783331616235643538222c226e756d626572223a223078366563353437222c226761734c696d6974223a223078376131323164222c2267617355736564223a223078373966653031222c2274696d657374616d70223a2230783565333932386263222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307838623638653937613336616437336566383437336365343636643932633634313339396532336364393032366561336539656465613835343035336131343765222c226e6f6e6365223a22307838353561613936393239326336653362222c2268617368223a22307832326437336361356662626230633864376434333339623133613432343339663133343963633735633563616134633935623666336463613235343435633730227d")
		header7259464, _ := hex.DecodeString("7b22706172656e7448617368223a22307832326437336361356662626230633864376434333339623133613432343339663133343963633735633563616134633935623666336463613235343435633730222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307836633836653661613830303566663433356264656639393736653433396434616339333866616466346231656537663031376563333664313661346131623266222c227472616e73616374696f6e73526f6f74223a22307864316635353761623865663631396461313664633266366338363165613034373737616664623766646666373763363964343462653130373165306362656332222c227265636569707473526f6f74223a22307864623563643163643264336533343936653533343762666532643764326561653534356264303466393863373330343364323165386664373065656536633837222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030343030383030303030303430303030343030303030303030303030303030303030303030303831303030303030303030303031303030303031303030323030306130303031303034303032313030303030303039303030303030303030303830313030303831323030303438303030303230303030303030323030303030633030303038303034303430303038303030303030303030323030303030303030303030303030303030303030343031303030303434303432303030303030303030303830303130303030303030303030303030303834303434303030303030303030303130303030303032303030303030323030303032303530303030343031323030303030313030303030383030313030303032303030303030303030303030303030303030303030303430303230303030303030323030303034303030303030303030313030303036303030303030303030303230303030303030303030303030303030303030303030303038303030363032303030303030303030303030303032306430303430303030303030303030343030303030303030303030303030303030303030303030323030303330303230323030303230303230303030303038303030613030303030303030303030303230323032303030303134303530303030303030313134303030222c22646966666963756c7479223a2230783331396566323832222c226e756d626572223a223078366563353438222c226761734c696d6974223a223078376131323164222c2267617355736564223a223078326562663137222c2274696d657374616d70223a2230783565333932386463222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307866643433393339333563666130343861653762653761616136313162623036383638303935326335393262383831313333333366643733323236393637616232222c226e6f6e6365223a22307838353561613936393133333264363966222c2268617368223a22307836336162343534613932666466356634363865356462393031306234633663626334636664393661386332316430353333623638386636633837313334643334227d")
		header7259465, _ := hex.DecodeString("7b22706172656e7448617368223a22307836336162343534613932666466356634363865356462393031306234633663626334636664393661386332316430353333623638386636633837313334643334222c2273686133556e636c6573223a22307831646363346465386465633735643761616238356235363762366363643431616433313234353162393438613734313366306131343266643430643439333437222c226d696e6572223a22307836333562343736346431393339646661636433613830313437323631353961626332373762656363222c227374617465526f6f74223a22307864663265313332303766336161623238396662393662343963363430326462303362376664396435396266663761353632363164326161393331376462666464222c227472616e73616374696f6e73526f6f74223a22307838383338303065333166303934633664356136663832613631663835316237323232353631303930306139653739626165386534323839313464636334353263222c227265636569707473526f6f74223a22307830353662323366626261343830363936623635666535613539623866323134386131323939313033633466353764663833393233336166326366346361326432222c226c6f6773426c6f6f6d223a2230783030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030222c22646966666963756c7479223a2230783331613532363630222c226e756d626572223a223078366563353439222c226761734c696d6974223a223078376131323164222c2267617355736564223a22307835323038222c2274696d657374616d70223a2230783565333932386465222c22657874726144617461223a2230786465383330323035306438663530363137323639373437393264343537343638363537323635373536643836333132653333333832653330383236633639222c226d697848617368223a22307835316430396562623331616664353963626432386663373437393237313437373839343966306230353039303164306235376335396661366130343333343564222c226e6f6e6365223a22307838353561613936393137623336396230222c2268617368223a22307861656632393933313662656362663339353738616565633438333265393332303830393732313065346661646331356230383031376466363966333134346462227d")

		param := new(synccom.SyncBlockHeaderParam)
		param.ChainID = 2
		param.Address = acct.Address
		param.Headers = append(param.Headers, header7259462)
		param.Headers = append(param.Headers, header7259463)
		param.Headers = append(param.Headers, header7259464)
		param.Headers = append(param.Headers, header7259465)
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), native.GetCacheDB())
		err := ethSyncHandler.SyncBlockHeader(native)
		assert.Equal(t, SUCCESS, typeOfError(err))
		height := getLatestHeight(native)
		assert.Equal(t, uint64(7259465), height)
	}
	{
		param := new(ccmcom.EntranceParam)
		proof := []byte(`{"address":"0x4b61a4c0ab51b53cfabf1339bfdb7dfd27be596a","balance":"0x0","codeHash":"0xd5415eb1d2e74e08407476508707137c7e35dbf42995dd07e273c83b4c384c9d","nonce":"0x1","storageHash":"0xac92f34547c3928bff4b16a01d011cdd313f5c8658a0ebbc419d731fc96aed01","accountProof":["0xf90211a044cdba96ea41a639286789665321c82b82da3af44c13a23e89cd7d12489f275ba04f667ad4dd8b93125a461fa90cba9824de0cc6e463963f70546d34eb5d0850ada090b90837f8e344dffde14735d66fb53204b77d546b2d588013f669a6d7cbb052a03fdca5da44fdfa953009a1a393c92af32d4aba170d9d4a355c72d74ff3609ee0a0fb715e667b8ea2a486fa7664b6319f9ad70c8a02a8523ea66018c8a800796312a0e1b0607233b4eb726ec99b875021cd7a419dfa7db281509b09d5e0e586bf20e5a0e0f020646f30505c6dee185e2b15b69b41229f4a5ef3bd1b86a7640323267d0da04a9248c1e2376c795d7e7092f5f269112a5ef0ba9f615691752d327a2e14db46a09434b2e9ce4f7902049c73069aa4e06a64e1b4f66ad28886c1d2dbce4f8d8885a049723843c76c139ee6a852913a15f867bf6996efeab24093831448a3fd319060a0c76af527df045ec8841d3844f75c0df45413eb39e4d133bca4ef6b9f34c14e9ba0e1d251bed147df5615e73e38b5116b9613edfbd40148698ba37d8aaa4c96d08ea0f71d80eb8db1138d42e8ba10e4bbf752e63ba3a2e6202cf77bd139b1f2037909a0cd5faa98e3fb40080b58bafb07477761d5259293313bba9dfa2a717263cc2c6aa0a7da5f100c1ad5e1adc36cbe42b2a75b8e98e7f6ed834f17d2d986220c68dd0ea070e309eb14f7938217f161f05a3322e4334fd71216e2cc39f5581a4968f39c9a80","0xf90211a0bc3c4c601894a3e2e1f63e6a0cb8ded9a45f9d490a48d2e468fa1ef0f811c46aa0ba2c588cfaa0f80fbf358c3122d87c450e0c3c4f4f11ee666f8d373542915ff3a0df808f83f713ba243c4d1f8524de68c1321a2997fe8e90707199fe273eff9e80a0b271d852ef674361d567538ac385fcc3a64393b83e74ca5042a80561ea930f41a09e394e781d7456fec9c3eee07958624ded9f3dd33a7417e911d829f1b8a3fc2da038836c839d052cfac47eadc38eef898e81a141b861aae160b458dc2a810377fca08e0f1718e800fff19325f89e794371576d317ef69a42bc58a7d06bb22bcea109a0248d5e1d35531a8ae584f4748ba9f066b2db80b66988735c4a42ebe9fe840e32a0f85898019742452e3e6f13ab0eba8be413f703f9b6ddb738a8ffee3a5b6921cfa0d8911f2a5d448d870e75995b5d424040f639ba07a018813c6c3f4534b2a40588a0940046d1f708d0a435ae58a899dca8f0cc2b10ba37bfd5a8e1ea31d2a6e7f370a09cc6a3faaf4dbb3ec1c6a545f69ee5ea4be632edfd7da38005466de113f4fe1ea071a50ff6f949b9b7b39754857b10f8e988f378e740c917fbc47d07363f348eb0a0b1df183e8603fb1c3aad3af711d2e15696f256f5dd2c94bd88be390f13013762a018f2794476d5b40a054196c7f2aa218c508cd4f10a85f71222a7c08ab5cbd109a0f296cfcd6b516e9c8d2c1a90c5ddd8393667baf9b7fc37f7b403f3a26d36e1c080","0xf90211a0616b9d83bd7f96de1864f0fe3e16badf4dfa89b8f3eba721a46c7f232d930e5ba09e71d9854994874d673e049153c7accf44196a6211b80ef97b3d29e636db521aa048d549ac792bbf2e3f07a7362b81f8817193c446c56eb66b71abe7ca6fe5c6a5a0e120d0b4dadef4604bd8b9250ad6ca3ca6b11da171e209a566924950af03571ba067f4f8626b8af02a4b7a33e546a55845051b3b81cde0e045d4508908b27a49aaa0ed55c43c8d4ef28c54b641660d457d4e0956cc1c63a77a98f39dd5f1f185b98ca08ddcf649ac1ca8df725e021298352a5daf44f9a1caedecd9fef2bd509ae43c0ea00223058d54f8445d1e53e2586600db633ed9aba3f81fa9977fabde53fca4b4d7a0c39638566db5d144df1521afe1e7451ec1836ead2eda423443b66ec0e113de30a011a3c497474d46e16a1f15c3558d5043a994a7df3e4f7e68025f344e12e7de85a0814c5111d3853dcfb4b3008e983364d68869897ef3d246e482f5d51c97dbef10a04d1605e0a23e25bb985b83a0f9743e632c737336cdf7394c1a9a4dfee19a9168a031e6c9c8329cbe268f83da4e8eca50a20a95c28f15780d332625f51122bdd797a05c1fb1a5be55ecc86189fd3a9ea070ec9e4b9394618c9cba8ef47eb77488dc02a0220348f330a91580351ba1be5c36264497e75f6fc1ddf109c80e0069819347f2a0809145f936a7b913fc86edc2dd914b5c835b2b17a4fb2cafda62ca6d2440df3680","0xf90211a0bcef09832cca3e0d23f7ea55f6e605bd36141a362094e57a698fe5a086ab3f2ea067f569bf8e06758f39fc95fb312f808cad88dc7a62cc82937ea7214d43216fcaa02832f266942fa9a3f6b55d05f8e6f1408f6d82356a761578c7dae9408b7f0d50a0c75bd37f1e94fc6c322e3e5b50b3e36efaa626b457df7ecacb3b8e65fad53bbaa03e4ff0b64aa60e9ea8329cadb49ba89f7cad0c541d525956b7484133aa973979a0d32e95abde9c3278cf4e7a16d4edcde194410ae0ce8df4ff78c5441236d53837a07703f8673c8d74beb4e639d0a4603b9026e20fea0c6547eda433df2d9b53dc56a0fac583c68287d294eb76815bb4841b992187add002f0e563b891e71d157af33aa096c85eaa274319ced0ead3cd0054563b59a2fbf750542e5029b83a5a5ded67e2a00cf31256126ad966492d04f22dbbc70880a5dbfcf3d795842b1a1fc36684e419a0359a1ab3ca5de3682cb57bbf0d5c9959f6c964e0f7c0e99580de14108fae6d9ca03e165d0a6c4d7e02bf4f459188eb5a0ec51ee3f960eaec1a8d9efa4a25e2fd25a031444ce52cb0b9d698f314acbbea8b98ca6df2a789ba35f1af64b07989659ca7a0b6e6da13a8361f323f7391facc8a20c5af184c8e345ab2396c94c868f420653ca0259dbbb9fed067946c475cfe4919ca6ac8f089fc61aa7fbd76f3b9b8f6271617a05b2f4edce7b144f1f00fc61539ac43b772684dc1953ad3a885630cb351fc257680","0xf90211a002e5af012079123236fdb908236ea6aebaddff546e2580424101a23211fbde75a003fd741237eb90196f5822f91888074b2180d250a8ff48b41563cd94a817becca06233754ce9b2df7e1ad659e5515b042fe9007f76274f38df178ade77f5b74440a007f4b142b3b9599e91052f14872506bb1bee0b7ee70dc242d19268a0d0eeaa12a0a0b5f6499ae2ef83a1be1e3d73e4b88b3d322911457e97abb42a23758bb351d3a08e35b9b0f4ad1b5a6fbddcdacaa2463d3d4d7c8dd406ce19cd206c6595db674ba02bf200d3016a9e9eee1976618999c27abdbd63b3c5e675d64a833b1685944352a024e0583914d4ab6c6cbb5aac193b479d48ab3254ab3e88e5b6544a882dcf8933a09d7b11fa377dbf3d92f06faea40962189f388e87fad8cf0ece2196b8b30e9da4a01667268a20948d7525d576628d2ba3707a94d3b1da0ba7f28a45bba4737d2894a08c0b6a7b94d696bf5c532c613e0feb3dba82c55c4fb01134c83c319402d2b871a0026671a3a43a954d025e47e750244cf4b04a8354fde6cbea9c467368049c1feea0507b816282aefd8f3b582bd6ae7d5acb037b313debc2028e57b9cae229e1db9ca09ce3d88f7e1f321e187d1b234c2493e81b5d7b47ad6f0cb0bfd1c9ac5e5f74a6a092c2f1e2ce6ea1015f77d98c0072e7ec9b1e18406b0ba41cff9c1cdae71c9542a0b34ec209c27899ca2b1ea2d07361ea00628d28e53414dd6bfa39c39cb7eaf23e80","0xf90191a07fe5ff2aa391a7ea09ac6d55f4621aaf23cb322e559c110f3bc3c7eb3eda7a8ca0230e6812eb0e8bba2ad95edc695412e33e85539d0eab1e96968bab9f9f1f019c80a0d28dd1d2320e9e15e8bef5636e8d3e2c9b32d9c1475c78e4a435bcd3e19b812aa07a33a6998479f52a1d7c06d675a6e876c68727a61caa34e39115f03efb3afc1280a0dd4290c3837afd01faa42f458e0486bbfc4885b57b5c835f0ee6fcf55b21a394a00f07b81acd0335f3263af89f877e72bd60a5b2b5bb3e0d6d8cbf5f5f5f85ce16a0e338a2c0be8577567cb62a6d58a95d8f59a5ff1b2711f75bb31ccc094bf7aaafa0d5b82a1d9af21fee4199b9867316f027f9af7d3773e1710ce7d200a93c67fef8a023963250bd9f8e7a05e57c71bbeeb1c2543777aad8175579d4a285eb966e2cf580a0619d3a8d0f12f692c9cb482d18f6d89b9f4dc4387f1a5c3d5695a58e169c6aeaa026047caa832100fdac0ade771d2559e4b250c1ebd4d3f2c58ce3ffb8a73a3a54a0aa24cea6d585f51e7363e9188e0ceca15a2fcf8ef7b06ffb8a244e38444893ab8080","0xf8679e20a156fa491379eaedeba66e5a505622acecbf4ba5671e47f00370827178b846f8440180a0ac92f34547c3928bff4b16a01d011cdd313f5c8658a0ebbc419d731fc96aed01a0d5415eb1d2e74e08407476508707137c7e35dbf42995dd07e273c83b4c384c9d"],"storageProof":[{"key":"0x50a82f9cbcdfaca82fe46b4a494d325ee6dc33d1fa55b218ab142e6cc2c8a58b","value":"0x2d37cc264865ae01b30172c43ac9ace29ba1dee20f10aa74ce291b26689c050b","proof":["0xf90211a0b07d4dbb8e1e7f7357496c011b008c5a49531e90725e1957d769dc720fcbd8d7a0172557790331f25ff2b5aada1d25bddf0fda4ea790a40ef0e596a45fe173b1e6a0e312e10d94bd7dad39723078aba881d4235043bc3c1ab59f44cea61c0e56a1b7a04d0c28f3e08dd98e7ea6597fbe6c604592c7f2359db9bc42bf3e4b8bf42459c5a0f1562a82dbc1994119ea29a65f255eda43959309171b4606f4011cafd0173ac2a01fc25384137fa860cb740f1811cea39bd6a5c86f52d45ad6d3a00b40f60d444aa089f45efd567de9edc6a8bfa4bc8684dc4118833a51a5f20d6d7c0e719586a909a06b6d587b1aa7fc7d81a56bc9cd20d621a1772c814cccc873692572bca93106d4a03d51ba86ef58614506f4c4425eda5692e71a818171a669dcaee5ea10f3902e38a09566b3631d046edda78a244db59304ccd8cea8287d23dcd0d03a77fcd60a0c1aa097c7251c12165854304785062c881394e9eeacc9bb55dd08a9331730bcae2711a0f677cebfff0adfd030227685d7c231fc9c8ecedb8b0fa62250948ff6f895efa9a0106b34679f06a804b941370b81bb6d68e79505a387a49dcd236a0a88063aa527a0579f36e4d3ae280c83851cb791e4ee75d80d832762e95275a15c1ae33657d9ffa0b7ca9f6e6fd1d25fbd44ced8561c290c3cabbf2891b4b8289ca54d671e887430a05177446b71571d22b976133f873355c383667a2d60e1ca3ebd882854a7aac8f580","0xf90191a0525d0baab303e971a33085929b03ad88fe97a9c2ab92480a4d09720599581c11a0e783b08ecb0ae24cbcb1804bc4f422557bce71f077adf4edf7c275a745ed5b2a8080a0c310a228b83f5310ca38b83415b7113ce621743b74fbbeb907944115859dbb4ca0085b66671b0eb402d360bfe181b2cb883720167bd782bf4bbdf920998a001414a05ee03832f17957b631b15db06fa7bdf3b8f0cd1c61d27af684ca60bd15e041bca0a4dae0acbd7fe8b71b48f520fef3c35b946cdce186b76e675595ddbbedb59363a0f81d3a61a2a23dc07866ea1ccaafb4368da835809cc7159ce8703ac8ead6cdcca046d79da3f2ac115f3da3e0cb95a77e778da969b02aa20a8841907a3fd4e1076f80a0e1d17b106cd31499d9700b73d5f8b5c5bdc02835ccc0486dc9d4d0b834de8a1980a0d860e04becc55860efa5f851d389d43d40177caa56f6244e0213ff58ecfdf53aa0dbb6dfc13a9106cf6aed1840f26a4a41ed9ad97b7f87e09cc1eb10beaee87092a0e974b76e9fd2af46966cbdf4aad7fb986b68ce470a660f6ac37d393149b99dbb80","0xf843a02038fd5b02a17455a63e08ef8acf42f0c690bb3323f43c6cfc048729c3a46670a1a02d37cc264865ae01b30172c43ac9ace29ba1dee20f10aa74ce291b26689c050b"]}]}`)
		value, _ := hex.DecodeString("20000000000000000000000000000000000000000000000000000000000000001320000000000000000000000000000000000000000000000000000000000000001314662e1b7ba042f389cb1b26c4d988e137d540fc4301000000000000000362746306756e6c6f636bfd1d01226d6a456f79794350734c7a4a3233784d58364d746931337a4d794e33366b7a6e353740420f0000000000f15521023ac710e73e1410718530b2686ce47f12fa3c470a9eb6085976b70b01c64c9f732102c9dc4d8f419e325bbef0fe039ed6feaf2079a2ef7b27336ddb79be2ea6e334bf2102eac939f2f0873894d8bf0ef2f8bbdd32e4290cbf9632b59dee743529c0af9e802103378b4a3854c88cca8bfed2558e9875a144521df4a75ab37a206049ccef12be692103495a81957ce65e3359c114e6c2fe9f97568be491e3f24d6fa66cc542e360cd662102d43e29299971e802160a92cfcd4037e8ae83fb8f6af138684bebdc5686f3b9db21031e415c04cbc9b81fbee6e04d8c902e8f61109a2c9883a959ba528c52698c055a57ae")
		param.SourceChainID = 2
		param.Height = 7259464
		param.Proof = proof
		param.RelayerAddress = acct.Address[:]
		param.Extra = value
		param.HeaderOrCrossChainMsg = []byte{}
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), native.GetCacheDB())
		_, err := ethTxHandler.MakeDepositProposal(native)
		assert.Equal(t, SUCCESS, typeOfError(err))
	}
	{
		param := new(ccmcom.EntranceParam)
		proof := []byte(`{"address":"0x4b61a4c0ab51b53cfabf1339bfdb7dfd27be596a","balance":"0x0","codeHash":"0xd5415eb1d2e74e08407476508707137c7e35dbf42995dd07e273c83b4c384c9d","nonce":"0x1","storageHash":"0xac92f34547c3928bff4b16a01d011cdd313f5c8658a0ebbc419d731fc96aed01","accountProof":["0xf90211a044cdba96ea41a639286789665321c82b82da3af44c13a23e89cd7d12489f275ba04f667ad4dd8b93125a461fa90cba9824de0cc6e463963f70546d34eb5d0850ada090b90837f8e344dffde14735d66fb53204b77d546b2d588013f669a6d7cbb052a03fdca5da44fdfa953009a1a393c92af32d4aba170d9d4a355c72d74ff3609ee0a0fb715e667b8ea2a486fa7664b6319f9ad70c8a02a8523ea66018c8a800796312a0e1b0607233b4eb726ec99b875021cd7a419dfa7db281509b09d5e0e586bf20e5a0e0f020646f30505c6dee185e2b15b69b41229f4a5ef3bd1b86a7640323267d0da04a9248c1e2376c795d7e7092f5f269112a5ef0ba9f615691752d327a2e14db46a09434b2e9ce4f7902049c73069aa4e06a64e1b4f66ad28886c1d2dbce4f8d8885a049723843c76c139ee6a852913a15f867bf6996efeab24093831448a3fd319060a0c76af527df045ec8841d3844f75c0df45413eb39e4d133bca4ef6b9f34c14e9ba0e1d251bed147df5615e73e38b5116b9613edfbd40148698ba37d8aaa4c96d08ea0f71d80eb8db1138d42e8ba10e4bbf752e63ba3a2e6202cf77bd139b1f2037909a0cd5faa98e3fb40080b58bafb07477761d5259293313bba9dfa2a717263cc2c6aa0a7da5f100c1ad5e1adc36cbe42b2a75b8e98e7f6ed834f17d2d986220c68dd0ea070e309eb14f7938217f161f05a3322e4334fd71216e2cc39f5581a4968f39c9a80","0xf90211a0bc3c4c601894a3e2e1f63e6a0cb8ded9a45f9d490a48d2e468fa1ef0f811c46aa0ba2c588cfaa0f80fbf358c3122d87c450e0c3c4f4f11ee666f8d373542915ff3a0df808f83f713ba243c4d1f8524de68c1321a2997fe8e90707199fe273eff9e80a0b271d852ef674361d567538ac385fcc3a64393b83e74ca5042a80561ea930f41a09e394e781d7456fec9c3eee07958624ded9f3dd33a7417e911d829f1b8a3fc2da038836c839d052cfac47eadc38eef898e81a141b861aae160b458dc2a810377fca08e0f1718e800fff19325f89e794371576d317ef69a42bc58a7d06bb22bcea109a0248d5e1d35531a8ae584f4748ba9f066b2db80b66988735c4a42ebe9fe840e32a0f85898019742452e3e6f13ab0eba8be413f703f9b6ddb738a8ffee3a5b6921cfa0d8911f2a5d448d870e75995b5d424040f639ba07a018813c6c3f4534b2a40588a0940046d1f708d0a435ae58a899dca8f0cc2b10ba37bfd5a8e1ea31d2a6e7f370a09cc6a3faaf4dbb3ec1c6a545f69ee5ea4be632edfd7da38005466de113f4fe1ea071a50ff6f949b9b7b39754857b10f8e988f378e740c917fbc47d07363f348eb0a0b1df183e8603fb1c3aad3af711d2e15696f256f5dd2c94bd88be390f13013762a018f2794476d5b40a054196c7f2aa218c508cd4f10a85f71222a7c08ab5cbd109a0f296cfcd6b516e9c8d2c1a90c5ddd8393667baf9b7fc37f7b403f3a26d36e1c080","0xf90211a0616b9d83bd7f96de1864f0fe3e16badf4dfa89b8f3eba721a46c7f232d930e5ba09e71d9854994874d673e049153c7accf44196a6211b80ef97b3d29e636db521aa048d549ac792bbf2e3f07a7362b81f8817193c446c56eb66b71abe7ca6fe5c6a5a0e120d0b4dadef4604bd8b9250ad6ca3ca6b11da171e209a566924950af03571ba067f4f8626b8af02a4b7a33e546a55845051b3b81cde0e045d4508908b27a49aaa0ed55c43c8d4ef28c54b641660d457d4e0956cc1c63a77a98f39dd5f1f185b98ca08ddcf649ac1ca8df725e021298352a5daf44f9a1caedecd9fef2bd509ae43c0ea00223058d54f8445d1e53e2586600db633ed9aba3f81fa9977fabde53fca4b4d7a0c39638566db5d144df1521afe1e7451ec1836ead2eda423443b66ec0e113de30a011a3c497474d46e16a1f15c3558d5043a994a7df3e4f7e68025f344e12e7de85a0814c5111d3853dcfb4b3008e983364d68869897ef3d246e482f5d51c97dbef10a04d1605e0a23e25bb985b83a0f9743e632c737336cdf7394c1a9a4dfee19a9168a031e6c9c8329cbe268f83da4e8eca50a20a95c28f15780d332625f51122bdd797a05c1fb1a5be55ecc86189fd3a9ea070ec9e4b9394618c9cba8ef47eb77488dc02a0220348f330a91580351ba1be5c36264497e75f6fc1ddf109c80e0069819347f2a0809145f936a7b913fc86edc2dd914b5c835b2b17a4fb2cafda62ca6d2440df3680","0xf90211a0bcef09832cca3e0d23f7ea55f6e605bd36141a362094e57a698fe5a086ab3f2ea067f569bf8e06758f39fc95fb312f808cad88dc7a62cc82937ea7214d43216fcaa02832f266942fa9a3f6b55d05f8e6f1408f6d82356a761578c7dae9408b7f0d50a0c75bd37f1e94fc6c322e3e5b50b3e36efaa626b457df7ecacb3b8e65fad53bbaa03e4ff0b64aa60e9ea8329cadb49ba89f7cad0c541d525956b7484133aa973979a0d32e95abde9c3278cf4e7a16d4edcde194410ae0ce8df4ff78c5441236d53837a07703f8673c8d74beb4e639d0a4603b9026e20fea0c6547eda433df2d9b53dc56a0fac583c68287d294eb76815bb4841b992187add002f0e563b891e71d157af33aa096c85eaa274319ced0ead3cd0054563b59a2fbf750542e5029b83a5a5ded67e2a00cf31256126ad966492d04f22dbbc70880a5dbfcf3d795842b1a1fc36684e419a0359a1ab3ca5de3682cb57bbf0d5c9959f6c964e0f7c0e99580de14108fae6d9ca03e165d0a6c4d7e02bf4f459188eb5a0ec51ee3f960eaec1a8d9efa4a25e2fd25a031444ce52cb0b9d698f314acbbea8b98ca6df2a789ba35f1af64b07989659ca7a0b6e6da13a8361f323f7391facc8a20c5af184c8e345ab2396c94c868f420653ca0259dbbb9fed067946c475cfe4919ca6ac8f089fc61aa7fbd76f3b9b8f6271617a05b2f4edce7b144f1f00fc61539ac43b772684dc1953ad3a885630cb351fc257680","0xf90211a002e5af012079123236fdb908236ea6aebaddff546e2580424101a23211fbde75a003fd741237eb90196f5822f91888074b2180d250a8ff48b41563cd94a817becca06233754ce9b2df7e1ad659e5515b042fe9007f76274f38df178ade77f5b74440a007f4b142b3b9599e91052f14872506bb1bee0b7ee70dc242d19268a0d0eeaa12a0a0b5f6499ae2ef83a1be1e3d73e4b88b3d322911457e97abb42a23758bb351d3a08e35b9b0f4ad1b5a6fbddcdacaa2463d3d4d7c8dd406ce19cd206c6595db674ba02bf200d3016a9e9eee1976618999c27abdbd63b3c5e675d64a833b1685944352a024e0583914d4ab6c6cbb5aac193b479d48ab3254ab3e88e5b6544a882dcf8933a09d7b11fa377dbf3d92f06faea40962189f388e87fad8cf0ece2196b8b30e9da4a01667268a20948d7525d576628d2ba3707a94d3b1da0ba7f28a45bba4737d2894a08c0b6a7b94d696bf5c532c613e0feb3dba82c55c4fb01134c83c319402d2b871a0026671a3a43a954d025e47e750244cf4b04a8354fde6cbea9c467368049c1feea0507b816282aefd8f3b582bd6ae7d5acb037b313debc2028e57b9cae229e1db9ca09ce3d88f7e1f321e187d1b234c2493e81b5d7b47ad6f0cb0bfd1c9ac5e5f74a6a092c2f1e2ce6ea1015f77d98c0072e7ec9b1e18406b0ba41cff9c1cdae71c9542a0b34ec209c27899ca2b1ea2d07361ea00628d28e53414dd6bfa39c39cb7eaf23e80","0xf90191a07fe5ff2aa391a7ea09ac6d55f4621aaf23cb322e559c110f3bc3c7eb3eda7a8ca0230e6812eb0e8bba2ad95edc695412e33e85539d0eab1e96968bab9f9f1f019c80a0d28dd1d2320e9e15e8bef5636e8d3e2c9b32d9c1475c78e4a435bcd3e19b812aa07a33a6998479f52a1d7c06d675a6e876c68727a61caa34e39115f03efb3afc1280a0dd4290c3837afd01faa42f458e0486bbfc4885b57b5c835f0ee6fcf55b21a394a00f07b81acd0335f3263af89f877e72bd60a5b2b5bb3e0d6d8cbf5f5f5f85ce16a0e338a2c0be8577567cb62a6d58a95d8f59a5ff1b2711f75bb31ccc094bf7aaafa0d5b82a1d9af21fee4199b9867316f027f9af7d3773e1710ce7d200a93c67fef8a023963250bd9f8e7a05e57c71bbeeb1c2543777aad8175579d4a285eb966e2cf580a0619d3a8d0f12f692c9cb482d18f6d89b9f4dc4387f1a5c3d5695a58e169c6aeaa026047caa832100fdac0ade771d2559e4b250c1ebd4d3f2c58ce3ffb8a73a3a54a0aa24cea6d585f51e7363e9188e0ceca15a2fcf8ef7b06ffb8a244e38444893ab8080","0xf8679e20a156fa491379eaedeba66e5a505622acecbf4ba5671e47f00370827178b846f8440180a0ac92f34547c3928bff4b16a01d011cdd313f5c8658a0ebbc419d731fc96aed01a0d5415eb1d2e74e08407476508707137c7e35dbf42995dd07e273c83b4c384c9d"],"storageProof":[{"key":"0x50a82f9cbcdfaca82fe46b4a494d325ee6dc33d1fa55b218ab142e6cc2c8a58b","value":"0x2d37cc264865ae01b30172c43ac9ace29ba1dee20f10aa74ce291b26689c050b","proof":["0xf90211a0b07d4dbb8e1e7f7357496c011b008c5a49531e90725e1957d769dc720fcbd8d7a0172557790331f25ff2b5aada1d25bddf0fda4ea790a40ef0e596a45fe173b1e6a0e312e10d94bd7dad39723078aba881d4235043bc3c1ab59f44cea61c0e56a1b7a04d0c28f3e08dd98e7ea6597fbe6c604592c7f2359db9bc42bf3e4b8bf42459c5a0f1562a82dbc1994119ea29a65f255eda43959309171b4606f4011cafd0173ac2a01fc25384137fa860cb740f1811cea39bd6a5c86f52d45ad6d3a00b40f60d444aa089f45efd567de9edc6a8bfa4bc8684dc4118833a51a5f20d6d7c0e719586a909a06b6d587b1aa7fc7d81a56bc9cd20d621a1772c814cccc873692572bca93106d4a03d51ba86ef58614506f4c4425eda5692e71a818171a669dcaee5ea10f3902e38a09566b3631d046edda78a244db59304ccd8cea8287d23dcd0d03a77fcd60a0c1aa097c7251c12165854304785062c881394e9eeacc9bb55dd08a9331730bcae2711a0f677cebfff0adfd030227685d7c231fc9c8ecedb8b0fa62250948ff6f895efa9a0106b34679f06a804b941370b81bb6d68e79505a387a49dcd236a0a88063aa527a0579f36e4d3ae280c83851cb791e4ee75d80d832762e95275a15c1ae33657d9ffa0b7ca9f6e6fd1d25fbd44ced8561c290c3cabbf2891b4b8289ca54d671e887430a05177446b71571d22b976133f873355c383667a2d60e1ca3ebd882854a7aac8f580","0xf90191a0525d0baab303e971a33085929b03ad88fe97a9c2ab92480a4d09720599581c11a0e783b08ecb0ae24cbcb1804bc4f422557bce71f077adf4edf7c275a745ed5b2a8080a0c310a228b83f5310ca38b83415b7113ce621743b74fbbeb907944115859dbb4ca0085b66671b0eb402d360bfe181b2cb883720167bd782bf4bbdf920998a001414a05ee03832f17957b631b15db06fa7bdf3b8f0cd1c61d27af684ca60bd15e041bca0a4dae0acbd7fe8b71b48f520fef3c35b946cdce186b76e675595ddbbedb59363a0f81d3a61a2a23dc07866ea1ccaafb4368da835809cc7159ce8703ac8ead6cdcca046d79da3f2ac115f3da3e0cb95a77e778da969b02aa20a8841907a3fd4e1076f80a0e1d17b106cd31499d9700b73d5f8b5c5bdc02835ccc0486dc9d4d0b834de8a1980a0d860e04becc55860efa5f851d389d43d40177caa56f6244e0213ff58ecfdf53aa0dbb6dfc13a9106cf6aed1840f26a4a41ed9ad97b7f87e09cc1eb10beaee87092a0e974b76e9fd2af46966cbdf4aad7fb986b68ce470a660f6ac37d393149b99dbb80","0xf843a02038fd5b02a17455a63e08ef8acf42f0c690bb3323f43c6cfc048729c3a46670a1a02d37cc264865ae01b30172c43ac9ace29ba1dee20f10aa74ce291b26689c050b"]}]}`)
		value, _ := hex.DecodeString("20000000000000000000000000000000000000000000000000000000000000001320000000000000000000000000000000000000000000000000000000000000001314662e1b7ba042f389cb1b26c4d988e137d540fc4301000000000000000362746306756e6c6f636bfd1d01226d6a456f79794350734c7a4a3233784d58364d746931337a4d794e33366b7a6e353740420f0000000000f15521023ac710e73e1410718530b2686ce47f12fa3c470a9eb6085976b70b01c64c9f732102c9dc4d8f419e325bbef0fe039ed6feaf2079a2ef7b27336ddb79be2ea6e334bf2102eac939f2f0873894d8bf0ef2f8bbdd32e4290cbf9632b59dee743529c0af9e802103378b4a3854c88cca8bfed2558e9875a144521df4a75ab37a206049ccef12be692103495a81957ce65e3359c114e6c2fe9f97568be491e3f24d6fa66cc542e360cd662102d43e29299971e802160a92cfcd4037e8ae83fb8f6af138684bebdc5686f3b9db21031e415c04cbc9b81fbee6e04d8c902e8f61109a2c9883a959ba528c52698c055a57ae")
		param.SourceChainID = 2
		param.Height = 7259464
		param.Proof = proof
		param.RelayerAddress = acct.Address[:]
		param.Extra = value
		param.HeaderOrCrossChainMsg = []byte{}
		sink := common.NewZeroCopySink(nil)
		param.Serialization(sink)

		native = NewNative(sink.Bytes(), native.GetCacheDB())
		_, err := ethTxHandler.MakeDepositProposal(native)
		assert.Equal(t, TX_HAS_COMMIT, typeOfError(err))
	}
}
